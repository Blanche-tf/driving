Simple.Module({name:"jxb:application/container/main",require:["./view/main"]},function(e,t,a,n){var i=n.Utils,o=n.Router,s=e("./view/main");t.exports=n.Application.extend({$constructor:function(){this.$super(),this.state={path:location.href,isLoading:!1},this.application=[]},getUserInfo:function(){var e=this;n.request("jxb://api/open/admin/user/me.htm").done(function(t){e.setState({userInfo:t})})},getRoleInfo:function(){var e=this;location.hash.substring(2);n.request("jxb://api/open/admin/jiaxiao/role.htm").done(function(t){e.setState({roleInfo:t}),n.Tools.setStorage("userType",t.userType),n.Tools.approveStatus=t.approveStatus})},didMount:function(){var e=this;e.getRoleInfo();var t=function(e){return e&&e!==document?"a"===e.tagName.toLowerCase()?e.href&&"jump"!==e.getAttribute("data-ref")?e.href:null:t(e.parentNode):null};e.initUI(),n.Dialog.map=e.children.MyMap,n.Dialog.image=e.children.ImageShow,e.event.on(document.body,"mousedown",function(e){if(1===e.button)return!1}),e.event.on(document.body,"click",function(a){var i,o=t(a.target);return o&&-1===o.indexOf("data:")&&!a.target.getAttribute("download")&&"true"!==a.target.getAttribute("no")?(i=o.replace(/http(s|):\/\/[^/]*\//gi,""),e.children.sidebar.checkQx(i)?location.hash.replace("#!/","").replace(/\?\w*/gi,"")===i.replace(/\?\w*/gi,"")?(a.preventDefault(),!1):(1===n.Tools.approveStatus||"dashboard/"===i||"driving-school/auth-infomation/"===i)&&(n.Tools.router("/"+i),a.preventDefault(),!1):(a.preventDefault(),!1)):!(o&&"true"!==a.target.getAttribute("validate")&&!e.children.header.toastErr())&&void 0}),e.event.on(window,"hashchange",function(){e.routerGo(location.href)})},login:function(e){this.children.login.show(e)},initUI:function(){var e=this;n.Dialog.isLoading=function(t){e.setState({isLoading:t})},n.viewImg=function(e){if(e){var t=[];"string"==typeof e?t.push(e):t=e;var a=document.createElement("div");return t.forEach(function(e){var t=document.createElement("img");t.src=e,a.append(t)}),a.style.display="none",document.body.append(a),$(a).viewer().data("viewer")}},setTimeout(function(){$("#jxb-article").viewer()},1e3),e.initToolTip()},initToolTip:function(){document.body.onmouseover=function(e){var t=e.target,a=t.getAttribute("tooltip"),n=document.getElementById("mytooltip");if(a){var i=$(t).offset(),o=i.left,s=i.top,r=t.getAttribute("lock")||"left";if((n=document.getElementById("mytooltip"))&&n.title===a)return;n||((n=document.createElement("span")).setAttribute("class","mytooltip"),n.setAttribute("id","mytooltip"),document.body.appendChild(n)),n.style.display="block",n.innerHTML=a.replace(/\n/g,"<br/>"),"right"===r?(s-=(n.offsetHeight-t.offsetHeight)/2,o+=t.offsetWidth+20):"left"===r&&(s-=(n.offsetHeight-t.offsetHeight)/2,o-=n.offsetWidth+t.offsetWidth),n.setAttribute("class","mytooltip "+r),n.setAttribute("style","left:"+o+"px;top:"+s+"px;"),t.classList.add("mytip")}else n&&(n.style.display="none")}},alert:function(e,t){},message:function(e,t,a,n){this.children.dialog.open({title:t||"",content:e||"",confirm:{text:a,callback:function(){n&&n()}}})},confirm:function(e){this.children.dialog.open({title:e.title,content:e.content,confirm:{text:e.confirm,callback:function(){e.callback&&e.callback(!0)}},cancel:{text:e.cancel,callback:function(){e.callback&&e.callback(!1)}}})},routerGo:function(e){this.setState({path:location.href}),o.go(e),i.each(n.Container.application,function(e){e.unmount()}),n.Container.application=[]},name:t.id,view:s})}),Simple.Module({name:"jxb:application/container/view/main",require:["jxb:component/confirm/main","jxb:component/header/main","jxb:component/login/main","jxb:component/sidebar/main","jxb:component/map-dialog/main"]},function(e,t,a,n){t.exports=n.View.create({id:t.id,isLoad:!0,component:{dialog:e("jxb:component/confirm/main"),header:e("jxb:component/header/main"),login:e("jxb:component/login/main"),sidebar:e("jxb:component/sidebar/main"),MyMap:e("jxb:component/map-dialog/main")},events:{},include:[],tagName:"container",media:[null,null],style:["common:css/main","./main"],template:function(e,t,a,n,i){"use strict";var o=this,s=[],r=(this.$helpers,e.props,e.self),l=e.state,d=o.$escape,c=function(){return o.$component(arguments,a)};r.props,l=r.state;return s.push('<container class="'+d(l.sideDian?"active":"")+'">'),s.push(c("MyMap.0",{skip:"true"},null,i)),s.push(c("login.0",{skip:"true"},null,i)),s.push(c("dialog.0",{skip:"true"},null,i)),s.push(c("header.0",{roleInfo:l.roleInfo},null,i)),l.roleInfo&&s.push(c("sidebar.0",{path:l.path,roleInfo:l.roleInfo},null,i)),s.push('<article skip="true" class="'+d(l.isHome?"home":"")+'" id="jxb-article"></article>'),l.isLoading&&s.push('<div class="simple-loading"><div class="loading-img"></div></div>'),s.push("</container>"),o.$resolve(s)}})}),Simple.Module({name:"jxb:component/confirm/main",require:["./view/main"]},function(e,t,a,n){var i=e("./view/main");t.exports=n.Component.extend({$constructor:function(){this.$super(),this.state={svg:'<svg viewBox="25 25 50 50" class="circular"><circle cx="50" cy="50" r="20" fill="none" class="path"></circle></svg>'},this.props={}},didMount:function(e){var t=this;n.Dialog.alert=function(e){e||(e={}),"object"!=typeof e&&(e={content:e}),t.children.dialog.show({title:e.title||!1,content:'<div class="dialog-confir-text">'+(e.content||"")+"</div>",width:480,confirmText:e.confirmText||"\u786e\u5b9a",onConfirm:e.onClick||e.onConfirm||function(){this.hide()},onContent:e.onContent||null,showCancel:!1})},n.Dialog.html=function(e){e||(e={}),t.children.dialog.show({title:e.title||!1,content:e.content||"",width:e.width||480,showBg:e.showBg,showClose:e.showClose,confirmText:e.confirmText||"\u786e\u5b9a",showBtn:e.showBtn,onConfirm:e.onClick||e.onConfirm||function(){this.hide()},onClose:e.onClose||function(){this.hide()},showCancel:!1})},n.Dialog.confirm=function(e){e||(e={}),t.children.dialog.show({title:!1,width:480,content:'<div class="dialog-confir-text">'+(e.content||"")+"</div>",confirmText:e.confirmText||"\u786e\u5b9a",cancelText:e.cancelText||"\u53d6\u6d88",onConfirm:e.onClick||e.onConfirm,onCancel:e.onCancel})},n.Dialog.toast=function(e){t.setState({toast:e}),setTimeout(function(){t.setState({toast:""})},1500)},n.Dialog.loading=function(e){t.setState({loading:e})},n.Dialog.loadingHide=function(){t.setState({loading:""})}},view:i,name:t.id}),t.exports.setName(t.id)}),Simple.Module({name:"jxb:component/confirm/view/main",require:["jxb:component/dialog/main"]},function(e,t,a,n){t.exports=n.View.create({id:t.id,isLoad:!0,component:{dialog:e("jxb:component/dialog/main")},events:{},include:[],tagName:"div",media:[null],style:["./main"],template:function(e,t,a,n,i){"use strict";var o=this,s=[],r=(this.$helpers,e.state),l=e.self,d=o.$escape;r=l.state;return s.push('<div class="dialog-confirm"><p class="toast '+d(r.toast?"show":"")+'">'+d(r.toast)+'</p><p class="toast loading '+d(r.loading?"show":"")+'">'+d(r.loading)+"</p>"),s.push(function(){return o.$component(arguments,a)}("dialog.0",{skip:"true"},null,i)),s.push("</div>"),o.$resolve(s)}})}),Simple.Module({name:"jxb:component/dialog/main",require:["./view/main"]},function(e,t,a,n){var i=e("./view/main");t.exports=n.Component.extend({$constructor:function(){this.$super(),this.props={},this.state={config:{title:"",showCancel:!0}}},isDialog:!0,show:function(e){var t=this;t.setState({show:!0,config:e}),setTimeout(function(){t.setState({showIn:!0})},50),document.getElementById("jxb-article").style.zIndex=5},isShow:function(){return this.state.show},hide:function(){var e=this;e.setState({showIn:!1}),setTimeout(function(){e.setState({show:!1,config:{}},!0),document.querySelector(".my-model.show")||(document.getElementById("jxb-article").style.zIndex="")},300)},willMount:function(){},didMount:function(e){var t=this;t.event.on("bg","click",function(){}),t.event.on(document.body,"keydown",function(e){27===e.keyCode&&t.isShow()&&t.hide()}),t.event.on("content","click",function(){}),t.event.on("modal-body","click",function(){t.state.config.onContent&&t.state.config.onContent.call(t)}),t.event.on("close","click",function(){t.state.config.onClose&&t.state.config.onClose.call(t),t.hide()}),t.event.on("cancel","click",function(){t.state.config.onCancel?(t.state.config.onCancel.call(t),t.hide()):t.hide()}),t.event.on("confirm","click",function(){t.state.config.confirmDisabled||t.state.config.onConfirm&&t.state.config.onConfirm.call(t)})},name:t.id,view:i})}),Simple.Module({name:"jxb:component/dialog/view/main",require:[]},function(e,t,a,n){t.exports=n.View.create({id:t.id,isLoad:!0,component:{},events:{},include:[],tagName:"div",media:[null],style:["./main"],template:function(e,t,a,n,i){"use strict";var o=[],s=(this.$helpers,e.props,e.self),r=e.state,l=e.config,d=this.$escape;s.props,l=(r=s.state).config||{};return o.push('<div class="my-model modal fade '+d(r.show?"show":"")+" "+d(r.showIn?"in":"")+'" ref="bg"><div class="modal-dialog" ref="content" style="width:'+d(l.width)+'px"><div class="modal-content" style="'+d(!1===l.showBg?"background-color:transparent":"")+'"><div class="modal-header '+d(!1===l.title?"new-header":"")+'">'),!1!==l.showClose&&o.push('<span class="close" ref="close" skip="true"></span>'),o.push('<h4 class="modal-title">'+d(l.title||"",["script"])+'</h4></div><div class="modal-body" ref="modal-body">'+d(l.content||s.content,["script"])+"</div>"),!1!==l.showBtn&&(o.push('<div class="modal-footer '+d(!1===l.title?"new-footer":"")+'">'),!1!==l.showCancel&&o.push('<button type="button" class="mybtn mybtn-edit size1" ref="cancel">'+d(l.cancelText||"\u53d6\u6d88",["script"])+"</button>"),o.push('<button type="button" class="mybtn mybtn-primary size1 '+d(l.confirmDisabled?"disabled":"")+'" ref="confirm">'+d(l.confirmText||"\u786e\u5b9a",["script"])+"</button></div>")),o.push("</div></div></div>"),this.$resolve(o)}})}),Simple.Module({name:"jxb:component/header/main",require:["./view/main"]},function(e,t,a,n){var i=e("./view/main");t.exports=n.Component.extend({$constructor:function(){this.$super(),this.state={}},isManager:function(){var e=this.props.roleInfo;return!!e&&!!e.cJiaxiaoAdmin},updateMessage:function(){var e=this;n.request("jxb://api/open/admin/notification/count.htm").done(function(t){t=t||{},e.setState({unreadCount:t.unreadCount,user:n.Tools.getStorage("userInfo")})})},getTabWidth:function(){var e=document.getElementById("nav-tabs");return this.state.tabWidth?this.state.tabWidth:e&&e.offsetWidth?(this.state.tabWidth=e.offsetWidth,this.state.tabWidth):1200},toastErr:function(){return n.Tools.toastErr()},didMount:function(e){var t=this;t.updateMessage(),t.event.on("userInfo","mouseover",function(){t.setState({zIndex:"z-index: 1"})}),t.event.on("userInfo","mouseout",function(){t.setState({zIndex:""})}),t.event.on("updatePwd","click",function(){t.children.UpdatePwd.show({phone:t.props.roleInfo.phone})}),t.event.on("tabLink","mouseup",function(e){var a=parseInt(e.refTarget.getAttribute("data-index")),n=t.state.tabs;if(1===e.button){if(1===n.length)return;var i=n[a].active;n.splice(a,1),i&&(n[n.length-1].active=!0,location.href="#!"+n[n.length-1].href),t.setState({tabs:n})}}),t.event.on("linkHome","click",function(){location.replace("")}),t.event.on("tabLink","click",function(e){var a=parseInt(e.refTarget.getAttribute("data-index")),i=t.state.tabs;n.Tools.router(i[a].href),i.forEach(function(e,t){i[t].active=t===a}),t.setState({tabs:i})}),t.event.on("tabClose","click",function(e){var a,n=parseInt(e.refTarget.getAttribute("data-index")),i=t.state.tabs;i[n].active;if(1!==i.length)return i.splice(n,1),a=i.length-1,i.forEach(function(e,t){e.active&&(a=t)}),i[a].active=!0,location.href="#!"+i[a].href,t.setState({tabs:i},!0),!1}),t.event.on("link","click",function(e){var a=e.refTarget.getAttribute("url");(e.refTarget.getAttribute("no")||t.toastErr())&&n.Tools.router(a)}),t.event.on("logout","click",function(){n.Tools.removeStorage("userInfo"),location.href="./login.html"}),t.event.on("fankui","click",function(){t.toastErr()&&t.children.Fankui.show()}),t.event.on("tongzhi","click",function(){t.toastErr()&&(t.setState({unreadCountHide:!0}),n.Tools.router("/system/message/"))})},name:t.id,view:i})}),Simple.Module({name:"jxb:component/header/view/main",require:["jxb:component/tab/main","jxb:component/dialog/main","jxb:component/form/main","jxb:component/fankui/main","jxb:component/update-pwd/main"]},function(e,t,a,n){t.exports=n.View.create({id:t.id,isLoad:!0,component:{Tabs:e("jxb:component/tab/main"),Dialog:e("jxb:component/dialog/main"),Form:e("jxb:component/form/main"),Fankui:e("jxb:component/fankui/main"),UpdatePwd:e("jxb:component/update-pwd/main")},events:{},include:[],tagName:"com:UpdatePwd",media:[null],style:["./main"],template:function(e,t,a,n,i){"use strict";var o=this,s=[],r=this.$helpers,l=e.state,d=e.self,c=(e.props,e.roleInfo),p=(e.user,e.userName),u=r.Simple,m=function(){return o.$component(arguments,a)},h=o.$escape,f=(e.tabWidth,e.len),v=e.width,x=o.$each;e.$value,e.$index,l=d.state,c=d.props.roleInfo||{},l.user;if((p=c.userName)||(p=u.Tools.getStorage("tempUserName")),s.push(m("UpdatePwd.0",{skip:"true"},null,i)),s.push('<com-header ref="header" style="'+h(l.zIndex)+'"><span class="logo" ref="linkHome" skip="true"></span><div class="user"><span class="user-lbl" ref="fankui" skip="true">\u53cd\u9988</span><span class="user-lbl '+h(l.unreadCount&&!0!==l.unreadCountHide?"new":"")+'" ref="tongzhi">\u901a\u77e5</span><div class="user-info" ref="userInfo"><div class="menu-name"><span class="mid">\u6b22\u8fce\u60a8'+h(p?"\uff0c"+p:"")+'</span><i class="down mid" skip="true"></i></div><div class="menu" skip="true"><div class="menu-li bt" ref="updatePwd">\u8bbe\u7f6e\u5bc6\u7801</div><div class="menu-li" ref="logout">\u9000\u51fa\u767b\u5f55</div></div></div>'),d.isManager()&&s.push('<span class="top-btn s1" ref="link" url="/vip/vip-invest/" skip="true">\u8d2d\u4e70\u4f1a\u5458</span><span class="top-btn s2" ref="link" url="/clue/index/" skip="true">\u67e5\u770b\u7ebf\u7d22</span><a class="top-btn s3" target="_blank" ref="link" no="true" href="'+h(u.MyHost.bxUrl)+'">\u4fdd\u9669\u5546\u57ce</a>'),s.push("</div>"),l.tabs){s.push('<div class="nav-tabs" id="nav-tabs"><ul class="my-nav">');v=d.getTabWidth()/(f=l.tabs.length)<130?"width:"+100/f+"%":"";x(l.tabs,function(e,t){s.push('<li class="'+h(e.active?"active":"")+'" ref="tabLink" data-index="'+h(t)+'" style="'+h(v)+'"><a>'+h(e.name)+'</a><i class="tab-close" ref="tabClose" data-index="'+h(t)+'"></i></li>')}),s.push("</ul></div>")}return s.push("</com-header>"),s.push(m("Fankui.0",{skip:"true"},null,i)),o.$resolve(s)}})}),Simple.Module({name:"jxb:component/tab/main",require:["./view/main"]},function(e,t,a,n){var i=e("./view/main");t.exports=n.Component.extend({$constructor:function(){this.$super(),this.state={}},didMount:function(e){var t=this;t.event.on("tab","click",function(e){var a=parseInt(e.refTarget.getAttribute("data-index"));t.props.onChange&&!1===t.props.onChange.call(t.parent,a)||t.setState({index:a})})},name:t.id,view:i})}),Simple.Module({name:"jxb:component/tab/view/main",require:[]},function(e,t,a,n){t.exports=n.View.create({id:t.id,isLoad:!0,component:{},events:{},include:[],tagName:"div",media:[null],style:["./main"],template:function(e,t,a,n,i){"use strict";var o=[],s=(this.$helpers,e.props),r=e.self,l=e.state,d=e.config,c=e.index,p=this.$each,u=(e.$value,e.$index,this.$escape);s=r.props,l=r.state,d=s.config;return(c=l.index)>=0||(c=s.index)>=0||(c=s.config.index||0),o.push('<div class="my-tabs"><ul class="clearfix">'),p(d.tabs,function(e,t){o.push('<li role="presentation" class="'+u(t===c?"active":"")+'" data-index="'+u(t)+'" ref="tab">'+u(e)+"</li>")}),o.push('</ul><div class="my-tabs-content tbs'+u(c+1)+'" ref="tabsList">'+u(r.content,["script"])+"</div></div>"),this.$resolve(o)}})}),Simple.Module({name:"jxb:component/form/main",require:["./view/main"]},function(e,t,a,n){var i=e("./view/main");t.exports=n.Component.extend({isForm:!0,$constructor:function(){this.$super(),this.props={},this.state={range:{},view:{}}},onUpload:function(e){var t=this.state.view;this.setState({view:n.Utils.extend(t,e)})},onChange:function(e,t,a,i){var o,s=this,r=s.state.view;for(var l in e)r[l]=e[l],o=e[l],t.setFormClass&&(s.state.formClass=t.name+o),"function"==typeof t.optionChange&&t.optionChange.call(s,o,r,a,i),this.setState({view:r},!0),this.validate(l);t.change&&t.change.forEach(function(e){s.props.config.columns.forEach(function(t,a){if(t.dataIndex===e.dataIndex){var i={};e.requestKey.forEach(function(e){var t=e.split("|");1===t.length?(t=t[0],i[t]=r[t],"string"==typeof i[t]&&0===i[t].indexOf("[")&&(i[t]=JSON.parse(i[t]).join(","))):(i[t[1]]=r[t[0]],"string"==typeof i[t[1]]&&0===i[t[1]].indexOf("[")&&(i[t[1]]=JSON.parse(i[t[1]]).join(",")))}),!function(e){for(var t in e)if(""===e[t])return!1;return!0}(i)?(s.props.config.columns[a].store=[],s.props.config.columns[a].key="",s.state.view[e.dataIndex]="",s.children[e.dataIndex].clear(),s.forceUpdate()):n.request(e.store,i).done(function(t){"function"==typeof e.dataFilter&&(t.itemList=e.dataFilter(t.itemList)),s.props.config.columns[a].store=n.Tools.tokv(t.itemList,{key:e.index.key,value:e.index.value}),s.props.config.columns[a].key="",s.state.view[e.dataIndex]="",s.children[e.dataIndex].clear(),s.forceUpdate()})}})})},save:function(){var e=this,t=e.props.config,a=e.validate(),i=n.Deferred();return a&&t.onBeforeSubmit&&(a=t.onBeforeSubmit(a,t)),a?e.state.isSaving?(n.Dialog.toast("\u6b63\u5728\u6267\u884c\u4e2d...\u8bf7\u52ff\u91cd\u590d\u64cd\u4f5c"),i.reject(),i):(e.state.isSaving=!0,n.request(t.store.save,a,"post").done(function(a){t.onAfterSubmit&&t.onAfterSubmit(a),e.clear(),e.state.isSaving=!1,i.resolve(a)}).fail(function(){i.reject(),e.state.isSaving=!1}),i):(i.reject(),i)},isObject:function(e){return"object"==typeof e},stringify:function(e){return JSON.stringify(e)},validate:function(e){var t=this.getDOMNode().form,a={},n=this.props.config,i=!0,o={};return n.columns.forEach(function(n,s){if("checkbox"===n.xtype){var r=[];if(t[n.dataIndex].length)for(var l=0;l<t[n.dataIndex].length;l++)t[n.dataIndex][l].checked&&r.push(t[n.dataIndex][l].value);else t[n.dataIndex].checked&&r.push(t[n.dataIndex].value);0===r.length?a[n.dataIndex]="":a[n.dataIndex]=JSON.stringify(r)}else"select"===n.xtype&&n.multiple?1===n.valueType&&0===t[n.dataIndex].value.indexOf("[")?a[n.dataIndex]=JSON.parse(t[n.dataIndex].value).join(","):0===t[n.dataIndex].value.indexOf("[")?a[n.dataIndex]=t[n.dataIndex].value:a[n.dataIndex]="["+t[n.dataIndex].value+"]":t[n.dataIndex]&&(a[n.dataIndex]=t[n.dataIndex].value);t[n.dataIndex2]&&(a[n.dataIndex2]=t[n.dataIndex2].value),!n.required||n.dataIndex!==e&&e?n.required||(o[n.dataIndex+"_err"]=""):!0!==n.required||a[n.dataIndex]?"email"!==n.required||/^([a-zA-Z]|[0-9])(\w|\-)+@[a-zA-Z0-9]+\.([a-zA-Z]{2,4})$/.test(a[n.dataIndex])?"phone"===n.required||"!phone"===n.required?"!phone"!==n.required||a[n.dataIndex]?/^1\d{10}$/.test(a[n.dataIndex])||(i=!1,a[n.dataIndex]?o[n.dataIndex+"_err"]="\u624b\u673a\u53f7\u7801\u683c\u5f0f\u4e0d\u6b63\u786e":o[n.dataIndex+"_err"]="\u624b\u673a\u53f7\u7801\u4e0d\u80fd\u4e3a\u7a7a"):o[n.dataIndex+"_err"]="":"number"===n.required||"!number"===n.required?"!number"!==n.required||a[n.dataIndex]?a[n.dataIndex]>9999999?(i=!1,o[n.dataIndex+"_err"]="\u6570\u5b57\u4e0d\u80fd\u8d85\u8fc77\u4f4d\u6570"):/^\d+$/.test(a[n.dataIndex])?o[n.dataIndex+"_err"]="":(i=!1,o[n.dataIndex+"_err"]=n.header+"\u53ea\u80fd\u4e3a\u6574\u6570"):o[n.dataIndex+"_err"]="":"price"!==n.required||isNaN(a[n.dataIndex])&&a[n.dataIndex]?"function"==typeof n.required&&n.required(a)?(i=!1,o[n.dataIndex+"_err"]=n.required(a)):o[n.dataIndex+"_err"]="":(i=!1,o[n.dataIndex+"_err"]=n.header+"\u683c\u5f0f\u4e0d\u6b63\u786e"):(i=!1,o[n.dataIndex+"_err"]="\u90ae\u7bb1\u683c\u5f0f\u4e0d\u6b63\u786e"):(i=!1,o[n.dataIndex+"_err"]=n.header+"\u4e0d\u80fd\u4e3a\u7a7a")}),this.setState(o),!!i&&a},init:function(){var e=this,t=e.props.config,a={},i=[],o=function(){var a=e.getDOMNode().form;t.columns.forEach(function(e){"checkbox"!==e.xtype&&"radio"!==e.xtype||(a[e.dataIndex].length>1?n.Utils.each(a[e.dataIndex],function(e){e.checked=null!==e.getAttribute("checked")}):a[e.dataIndex].checked=null!==a[e.dataIndex].getAttribute("checked"))})},s=function(a){var i=0,s=0;t.columns.forEach(function(r){"select"!==r.xtype&&"checkbox"!==r.xtype&&"radio"!==r.xtype||"string"!=typeof r.store&&"string"!=typeof r.store_||(r.store_||(r.store_=r.store),a&&r.change&&r.change.forEach&&r.change.forEach(function(e){var n={};e.requestKey.forEach(function(e){var t=e.split("|"),i=a[t[0]];try{i=JSON.parse(i).join(",")}catch(o){}1===t.length?n[t[0]]=i:n[t[1]]=i}),t.columns.forEach(function(t){t.dataIndex===e.dataIndex&&(t.params=n)})}),i++,n.request(r.store_,r.params).done(function(t){var a=t.constructor===Array?t:t.itemList;"function"==typeof r.dataFilter&&(a=r.dataFilter(a)),r.store=n.Tools.tokv(a,{key:r.index.key,value:r.index.value}),r.insert&&r.store.unshift.apply(r.store,r.insert),++s>0&&s===i&&setTimeout(function(){try{o()}catch(e){}},1e3),e.forceUpdate(),e.runWillMount=!0}))}),0===i&&setTimeout(function(){try{o()}catch(e){}},500)};if(t.store.load){if(!0===t.store.load)return t.data=JSON.parse(JSON.stringify(t.data)),"function"==typeof t.onBeforeRender&&(t.data=t.onBeforeRender.call(e,t.data)),i.forEach(function(e,a){i[a]=e+t.data[e]}),e.setState({view:t.data,hasFormClass:i.join(" ")},!0),void s(t.data);t.data&&(a.id=t.data.id),n.request(t.store.load,a).done(function(a){"function"==typeof t.onBeforeRender&&(a=t.onBeforeRender(a)),i.forEach(function(e,t){i[t]=e+a[e]}),e.setState({view:a,hasFormClass:i.join(" ")},!0),s(a)})}else s()},willMount:function(){this.init()},isArray:function(e){return e instanceof Array},parse:function(e){return JSON.parse(e)},clear:function(){var e=this,t=e.getDOMNode().form;e.props.config.columns.forEach(function(a){if("hidden"!==a.xtype){if("checkbox"===a.xtype||"radio"===a.xtype)for(var n=0;n<t[a.dataIndex].length;n++)t[a.dataIndex][n].checked=!1;else t[a.dataIndex]&&(t[a.dataIndex].value=a.value||"");t[a.dataIndex2]&&(t[a.dataIndex].value=a.value||""),delete e.state[a.dataIndex+"_err"]}}),e.state.view={},n.Utils.each(this.children,function(e){e.name.indexOf("MySelectInput")>=0||(e.name.indexOf("MySelect")>=0?e.clear():e.name.indexOf("MyUpload")>=0&&e.clear())}),e.forceUpdate()},getRangeLeft:function(e){return this.state.range[e]||0},didMount:function(){var e=this,t=e.getDOMNode().validateItem,a=e.props.config;a.columns.forEach(function(t){"function"==typeof t.ready&&t.ready.call(e)}),t&&!t.length&&(t=[t]),e.event.on("validateItem","input",function(t){var a=t.refTarget,n=a.value,i=a.parentNode.parentNode.querySelector(".s2");if(e.state.view[a.getAttribute("name")]=n,i){var o=a.getAttribute("max"),s=a.getAttribute("min"),r=(n-s)*((a.offsetWidth-10)/(o-s));i.innerHTML=n,i.parentNode.parentNode.style.left=r/a.offsetWidth*100+"%",e.state.range[a.name]=r/a.offsetWidth*100}}),e.event.on("validateItem","change",function(t){var n=t.refTarget.getAttribute("name"),i=parseInt(t.refTarget.getAttribute("data-index")),o=a.columns[i];e.state.view[n]=t.refTarget.value,o.onChange&&o.onChange.call(e,t.refTarget.value,e.state.view),e.validate(n)}),e.event.on("validateItemChk","change",function(t){var i=t.refTarget.getAttribute("name"),o=parseInt(t.refTarget.getAttribute("data-index")),s=(a.columns[o],e.getDOMNode()),r=[];n.Utils.each(s.myform.querySelectorAll('input[name="'+i+'"]'),function(e){e.checked&&r.push(e.value)}),"checkbox"===t.refTarget.type?e.state.view[i]=JSON.stringify(r):e.state.view[i]=t.refTarget.value,a.columns[o].onChange&&a.columns[o].onChange.call(e,t.refTarget.value,e.state.view),e.validate(i)}),e.event.on("dingwei","click",function(t){var i=parseInt(t.refTarget.getAttribute("data-index")),o=a.columns[i],s=e.state.view;n.Dialog.map.show({width:a.width,ops:{longitude:s[o[o.lng]],latitude:s[o[o.lat]],address:s[o.addressDataIndex]},onConfirm:function(t){s[o[o.lat]]=t.latitude,s[o[o.lng]]=t.longitude,o.onChange&&o.onChange(t,s),e.setState({view:s}),this.hide()}})}),e.event.on("buttonManager","click",function(t){var a=parseInt(t.refTarget.getAttribute("data-index")),n=e.props.config.buttons[a];"button"!==n.xtype||n.click&&n.click.call(e,n)}),e.event.on("saveBtn","click",function(){e.save().done(function(t){var a=0,n=e.parent;for(e.clear();n;){if(n.isDialog){n.hide();break}if(a>6)break;a++,n=n.parent}})}),e.event.on("closeBtn","click",function(){var t=e.parent,a=0;for(e.clear();t;){if(t.isDialog){t.hide();break}if(a>6)break;a++,t=t.parent}}),t&&t.length&&n.Utils.each(t,function(t){t.onblur=function(){this.value&&(e.state.view[t.getAttribute("name")]=this.value)}}),e.event.on("selectRaw","change",function(t){var a=parseInt(t.refTarget.dataset.index),n=e.props.config.columns[a],i=t.target.value;parseInt(i)==i&&(i=parseInt(i)),e.state.view[n.dataIndex]=i,e.setState(),n.onChange&&n.onChange.call(e,i,a,n)})},convertTo:function(e){return 0===e?"0":e},methods:{},name:t.id,view:i})}),Simple.Module({name:"jxb:component/form/view/main",require:["./select","./checkbox","./radio","../../select/main","../../upload/main","../../upload-cut/main","../../select-input/main"]},function(e,t,a,n){t.exports=n.View.create({id:t.id,isLoad:!0,component:{MySelect:e("../../select/main"),MyUpload:e("../../upload/main"),MyUploadCut:e("../../upload-cut/main"),MySelectInput:e("../../select-input/main")},events:{},include:["jxb:component/form/view/select","jxb:component/form/view/checkbox","jxb:component/form/view/radio"],tagName:"div",media:[null],style:["./main"],template:function(t,a,n,i,o){"use strict";var s=this,r=[],l=this.$helpers,d=t.props,c=t.self,p=t.state,u=t.config,m=t.view,h=t.title,f=l.Simple,v=s.$escape,x=s.$each,g=(t.$value,t.$index,t.boxCount),b=(t.v,t.rangeV,t.rangeB,t.selV,function(){return s.$component(arguments,n)}),y=(t.selKey,t.i,t.obj,function(o,s,r){return e(o).template(s||t,a,n,i,r)});t.dateConfig,t.dataIndex,t.min,t.max,t.box,d=c.props,p=c.state,u=d.config,m=p.view;if(r.push('<div class="my-form-container" ref="myform">'),u.buttons){r.push('<div class="row buttons"><div class="line" skip="true"></div><div class="col-md-2 table-name">');h='<span class="glyphicon glyphicon-ok mr5"></span>';h=f.Tools.isFunc(u.title)?u.title(m):u.title,r.push(v(h,["script"])+'</div><div class="col-md-10 textright">'),x(u.buttons,function(e,t){r.push('<button type="button" class="btn btn-'+v(e["class"]||"default")+' ml10" data-index="'+v(t)+'" ref="buttonManager">'+v(e.name)+"</button>")}),r.push("</div></div>")}if(u){r.push('<form autocomplete="off" class="form-horizontal my-form '+v(p.formClass||p.hasFormClass)+'" ref="form" onsubmit="return false;">');g=0;x(u.columns,function(e,t){if(r.push('<div key="a'+v(e.xtype+"-"+e.dataIndex+"-"+t)+'" style="height:'+v(e.height||u.columnsHeight)+"px;"+v(!0===e.show||e.show===undefined?"display:block":"display:none")+'" class="form-group '+v(e["class"])+" "+v(e.dataIndex)+" "+v(e.box?"box my-col-"+e.box:u.box?"box my-col-"+u.box:"")+" "+v(p[e.dataIndex+"_err"]?"has-error":"")+'">'),"hidden"===e.xtype){var a=m[e.dataIndex];c.isObject(a)&&(a=c.stringify(a)),r.push('<input type="hidden" class="form-control" id="'+v(e.dataIndex)+'" value="'+v(a||e.value)+'" name="'+v(e.dataIndex)+'" placeholder="'+v(e.placeholder)+'">')}else if("text"===e.xtype||"number"===e.xtype||"password"===e.xtype)r.push('<label for="'+v(e.dataIndex)+'" class="my-form-label control-label">'+v(e.header)+'<i class="red '+v(e.required&&-1===e.required.toString().indexOf("!")?" ":" empty")+'">*</i></label><div class="my-form-value"><input type="'+v(e.xtype)+'" '+v(e.disabled?"disabled":"")+' class="form-control" id="'+v(e.dataIndex)+'" ref="validateItem" data-index="'+v(t)+'" maxlength="'+v("phone"===e.required?11:e.maxlength||20)+'" autocomplete="off" name="'+v(e.dataIndex)+'" value="'+v(c.convertTo(m[e.dataIndex])||e.value)+'" placeholder="'+v(e.placeholder)+'">'),e.append&&r.push('<div class="my-form-addon">'+v(e.append,["script"])+"</div>"),(p[e.dataIndex+"_err"]||e.info)&&r.push('<label class="control-label" for="'+v(e.dataIndex)+'">'+v(p[e.dataIndex+"_err"]||e.info,["script"])+"</label>"),r.push("</div>");else if("range"===e.xtype){r.push('<label for="'+v(e.dataIndex)+'" class="my-form-label control-label">'+v(e.header)+'<i class="red '+v(e.required&&-1===e.required.toString().indexOf("!")?" ":" empty")+'">*</i></label><div class="my-form-value"><div class="range-div"><span class="rd-min">'+v(e.min)+'</span><span class="rd-max">'+v(e.max)+'</span><input type="'+v(e.xtype)+'" '+v(e.disabled?"disabled":"")+' class="form-control" id="'+v(e.dataIndex)+'" ref="validateItem" data-index="'+v(t)+'" max="'+v(e.max)+'" min="'+v(e.min)+'" step="'+v(e.step||1)+'" maxlength="'+v("phone"===e.required?11:e.maxlength||20)+'" autocomplete="off" name="'+v(e.dataIndex)+'" value="'+v(c.convertTo(m[e.dataIndex])||e.value)+'" placeholder="'+v(e.placeholder)+'">');var n=c.convertTo(m[e.dataIndex])||e.value,i=c.getRangeLeft(e.dataIndex)||(n-e.min)/(e.max-e.min)*100;r.push('<div class="range-tool" style="left:'+v(i)+'%"><div class="rt-center"><span class="s2">'+v(n)+"</span>"+v(e.rangeAppend||"\u516c\u91cc")+"</div></div>"),e.append&&r.push('<div class="my-form-addon">'+v(e.append,["script"])+"</div>"),(p[e.dataIndex+"_err"]||e.info)&&r.push('<label class="control-label" for="'+v(e.dataIndex)+'">'+v(p[e.dataIndex+"_err"]||e.info,["script"])+"</label>"),r.push("</div></div>")}else if("map"===e.xtype)r.push('<label for="'+v(e.dataIndex)+'" class="my-form-label control-label">'+v(e.header)+'<i class="red '+v(e.required?"":" empty")+'">*</i></label><div class="my-form-value"><input type="hidden" class="form-control" id="'+v(e.dataIndex)+'" value="'+v(m[e.dataIndex])+'" name="'+v(e.dataIndex)+'"><input type="hidden" class="form-control" id="'+v(e.dataIndex2)+'" value="'+v(m[e.dataIndex2])+'" name="'+v(e.dataIndex2)+'"><button type="button" class="mapbtn btn btn-primary" ref="dingwei" data-index="'+v(t)+'">'+v(e.placeholder)+"</button>"),(p[e.dataIndex+"_err"]||e.info)&&r.push('<label class="control-label" for="'+v(e.dataIndex)+'">'+v(p[e.dataIndex+"_err"]||e.info,["script"])+"</label>"),r.push("</div>");else if("textarea"===e.xtype)r.push('<label for="'+v(e.dataIndex)+'" class="my-form-label control-label">'+v(e.header)+'<i class="red '+v(e.required?"":" empty")+'">*</i></label><div class="my-form-value"><div class="mfv-mul">'),e.disabled?r.push('<textarea disabled="" class="form-control" id="'+v(e.dataIndex)+'" rows="'+v(e.rows||3)+'" ref="validateItem" data-index="'+v(t)+'" maxlength="'+v(e.maxlength||128)+'" autocomplete="off" name="'+v(e.dataIndex)+'" value="'+v(m[e.dataIndex]||e.value)+'" placeholder="'+v(e.placeholder)+'">'+v(m[e.dataIndex]||e.value)+"</textarea>"):r.push('<textarea type="text" class="form-control" oninput="this.nextElementSibling.children[0].innerHTML=this.value.length;" id="'+v(e.dataIndex)+'" rows="'+v(e.rows||3)+'" ref="validateItem" data-index="'+v(t)+'" maxlength="'+v(e.maxlength||128)+'" autocomplete="off" name="'+v(e.dataIndex)+'" value="'+v(m[e.dataIndex]||e.value)+'" placeholder="'+v(e.placeholder)+'">'+v(m[e.dataIndex]||e.value)+"</textarea>"),r.push('<div class="mfv-len"><i>'+v((m[e.dataIndex]||e.value||"").length)+"</i>/"+v(e.maxlength||128)+"</div></div>"),(p[e.dataIndex+"_err"]||e.info)&&r.push('<label class="control-label" for="'+v(e.dataIndex)+'">'+v(p[e.dataIndex+"_err"]||e.info,["script"])+"</label>"),r.push("</div>");else if("select"===e.xtype){r.push('<label for="'+v(e.dataIndex)+'" class="my-form-label control-label">'+v(e.header)+'<i class="red '+v(e.required?"":" empty")+'">*</i></label><div class="my-form-value"><input type="hidden" name="'+v(e.dataIndex)+'" value="'+v(c.convertTo(m[e.dataIndex])||e.key)+'">');var s=c.convertTo(m[e.dataIndex])||e.key;s&&e.multiple&&(c.isArray(s)||(s=0===s.indexOf("[")?c.parse(s):c.parse("["+s+"]"))),r.push(b("("+v(e.dataIndex)+")MySelect.0."+t,{data:e.store,setFormClass:e.setFormClass,disabled:e.disabled,optionChange:e.onChange,selectedKey:s,name:e.dataIndex,placeholder:e.placeholder,onChange:c.onChange,change:e.change,search:e.search,multiple:e.multiple},null,o)),(p[e.dataIndex+"_err"]||e.info)&&r.push('<label class="control-label" for="'+v(e.dataIndex)+'">'+v(p[e.dataIndex+"_err"]||e.info,["script"])+"</label>"),!e.infoEmpty||!e.store||e.store.length&&e.store[0].key||r.push('<label class="control-label red" for="'+v(e.dataIndex)+'">'+v(e.infoEmpty,["script"])+"</label>"),r.push("</div>")}else if("select-input"===e.xtype)r.push('<label for="'+v(e.dataIndex)+'" class="my-form-label control-label">'+v(e.header)+'<i class="red '+v(e.required?"":" empty")+'">*</i></label><div class="my-form-value">'),r.push(b("("+v(e.dataIndex)+")MySelectInput.0."+t,{data:e.store,value:m[e.dataIndex],name:e.dataIndex,placeholder:e.placeholder,onChange:e.onChange,onBlur:c.validate},null,o)),(p[e.dataIndex+"_err"]||e.info)&&r.push('<label class="control-label" for="'+v(e.dataIndex)+'">'+v(p[e.dataIndex+"_err"]||e.info,["script"])+"</label>"),r.push("</div>");else if("selectRaw"===e.xtype){r.push('<label for="'+v(e.dataIndex)+'" class="my-form-label control-label">'+v(e.header)+'<i class="red '+v(e.required?"":" empty")+'">*</i></label><div class="my-form-value">');var l=m[e.dataIndex]||e.key,d={v:a=e,i:t,view:m,selKey:l};r.push(y("./select",d,null)),(p[e.dataIndex+"_err"]||e.info)&&r.push('<label class="control-label" for="'+v(e.dataIndex)+'">'+v(p[e.dataIndex+"_err"]||e.info,["script"])+"</label>"),r.push("</div>")}else if("define"===e.xtype){r.push('<label for="'+v(e.dataIndex)+'" class="my-form-label control-label">'+v(e.header)+'<i class="red '+v(e.required?"":" empty")+'">*</i></label><div class="my-form-value">');a=m[e.dataIndex];c.isObject(a)&&(a=c.stringify(a)),r.push('<input type="hidden" name="'+v(e.dataIndex)+'" value="'+v(a)+'">'+v(e.render?e.render(m):"",["script"])),p[e.dataIndex+"_err"]&&r.push('<label class="control-label" for="'+v(e.dataIndex)+'">'+v(p[e.dataIndex+"_err"],["script"])+"</label>"),e.info&&r.push('<label class="control-label info" for="'+v(e.dataIndex)+'">'+v(e.info,["script"])+"</label>"),r.push("</div>")}else if("checkbox"===e.xtype){r.push('<label for="'+v(e.dataIndex)+'" class="my-form-label control-label">'+v(e.header)+'<i class="red '+v(e.required?"":" empty")+'">*</i></label><div class="my-form-value">');d={v:a=e,i:t,view:m};r.push(y("./checkbox",d,null)),(p[e.dataIndex+"_err"]||e.info)&&r.push('<label class="control-label col-xs-12 text-left" for="'+v(e.dataIndex)+'">'+v(p[e.dataIndex+"_err"]||e.info,["script"])+"</label>"),r.push("</div>")}else if("radio"===e.xtype){r.push('<label for="'+v(e.dataIndex)+'" class="my-form-label control-label">'+v(e.header)+'<i class="red '+v(e.required?"":" empty")+'">*</i></label><div class="my-form-value">');d={v:a=e,i:t,view:m};r.push(y("./radio",d,null)),(p[e.dataIndex+"_err"]||e.info)&&r.push('<label class="control-label col-xs-12 text-left" for="'+v(e.dataIndex)+'">'+v(p[e.dataIndex+"_err"]||e.info,["script"])+"</label>"),r.push("</div>")}else if("label"===e.xtype)r.push('<label for="'+v(e.dataIndex)+'" class="my-form-label control-label">'+v(e.header)+'<i class="red '+v(e.required?"":" empty")+'">*</i></label><div class="my-form-value control-label text-left">'+v(e.render?e.render(m[e.dataIndex]):m[e.dataIndex])+"</div>");else if("upload"===e.xtype)r.push('<label for="'+v(e.dataIndex)+'" class="my-form-label control-label">'+v(e.header,["script"])+'<i class="red '+v(e.required?"":" empty")+'">*</i></label><div class="my-form-value"><input type="hidden" name="'+v(e.dataIndex)+'" value="'+v(m[e.dataIndex])+'"><input type="hidden" name="'+v(e.dataIndex2)+'" value="'+v(m[e.dataIndex2])+'">'),r.push(b("("+v(e.dataIndex)+")MyUpload.0."+t,{name:e.dataIndex,max:e.max,maxSize:e.maxSize,multiple:e.multiple,onUpload:c.onUpload,desc:e.desc,store:e.store,accept:e.accept,dataName:e.dataIndex,moreData:e.moreData,fileName:e.dataIndex2,showDesc:e.showDesc},null,o)),p[e.dataIndex+"_err"]&&r.push('<label class="control-label" for="'+v(e.dataIndex)+'">'+v(p[e.dataIndex+"_err"],["script"])+"</label>"),e.info&&r.push('<div class="control-label info-label">'+v(e.info,["script"])+"</div>"),r.push("</div>");else if("upload-cut"===e.xtype)r.push('<label for="'+v(e.dataIndex)+'" class="my-form-label control-label">'+v(e.header)+'<i class="red '+v(e.required?"":" empty")+'">*</i></label><div class="my-form-value"><input type="hidden" name="'+v(e.dataIndex)+'" value="'+v(m[e.dataIndex])+'"><input type="hidden" name="'+v(e.dataIndex2)+'" value="'+v(m[e.dataIndex2])+'">'),r.push(b("("+v(e.dataIndex)+")MyUploadCut.0."+t,{name:e.dataIndex,onUpload:c.onUpload,maxSize:e.maxSize,desc:e.desc,store:e.store,accept:e.accept,dataName:e.dataIndex,fileName:e.dataIndex2,showDesc:e.showDesc},null,o)),p[e.dataIndex+"_err"]&&r.push('<label class="control-label" for="'+v(e.dataIndex)+'">'+v(p[e.dataIndex+"_err"],["script"])+"</label>"),e.info&&r.push('<div class="control-label info-label">'+v(e.info,["script"])+"</div>"),r.push("</div>");else if("date"===e.xtype){r.push('<label for="'+v(e.dataIndex)+'" class="my-form-label control-label">'+v(e.header)+'<i class="red '+v(e.required?"":" empty")+'">*</i></label><div class="my-form-value">');var h="{el:this,dateFmt:'"+(e.format?e.format:"yyyy-MM-dd")+"'}",x=e.dataIndex,I=e.min,w=e.max;w?h="{maxDate:'#F{$dp.$D(\\'"+w+"\\',{d:0});}',dateFmt:'"+(e.format||"yyyy-MM-dd")+"'}":I&&(h="{minDate:'#F{$dp.$D(\\'"+I+"\\',{d:0});}',dateFmt:'"+(e.format||"yyyy-MM-dd")+"'}"),r.push('<input type="text" '+v(e.disabled?"disabled":"")+' class="form-control date" ref="validateItem" data-index="'+v(t)+'" autocomplete="off" value="'+v(m[e.dataIndex]?f.Tools.date(m[e.dataIndex],e.format||"yyyy-MM-dd"):e.value||"")+'" name="'+v(e.dataIndex)+'" onclick="WdatePicker('+v(h)+')" id="'+v(x)+'" placeholder="'+v(e.placeholder)+'">'),(p[e.dataIndex+"_err"]||e.info)&&r.push('<label class="control-label" for="'+v(e.dataIndex)+'">'+v(p[e.dataIndex+"_err"]||e.info,["script"])+"</label>"),r.push("</div>")}else"image"===e.xtype&&(r.push('<label for="'+v(e.dataIndex)+'" class="my-form-label control-label">'+v(e.header)),e.required&&r.push('<i class="red" skip="true">*</i>'),r.push('</label><div class="my-form-value">'),e.render?r.push(""+v(e.render(m[e.dataIndex]))):m[e.dataIndex]?r.push('<img src="'+v(m[e.dataIndex])+'" alt="..." class="img-thumbnail" style="width:'+v(e.width)+'px">'):r.push('<div class="mt7" skip="true">\u6682\u65e0\u6570\u636e</div>'),r.push("</div>"));r.push("</div>");var k=e.box||u.box||12;!1!==e.show&&(g+=k),g%12==0&&g>0&&r.push('<div class="both-line" skip="true"></div>')}),u.showBtn&&r.push('<div class="form-group my-form-save-btn" skip="true"><button type="button" class="mybtn mybtn-edit size1" ref="closeBtn">\u53d6\u6d88</button><button type="button" class="mybtn mybtn-primary size1" ref="saveBtn">\u4fdd\u5b58</button></div>'),r.push("</form>")}return r.push("</div>"),s.$resolve(r)}})}),Simple.Module({name:"jxb:component/form/view/select",require:[]},function(e,t,a,n){t.exports=n.View.create({id:t.id,isLoad:!0,component:{},events:{},include:[],tagName:"select",media:[],style:[],template:function(e,t,a,n,i){"use strict";var o=[],s=(this.$helpers,this.$escape),r=e.v,l=e.i,d=this.$each,c=(e.$value,e.$index,e.selKey);return o.push('<select class="form-control" name="'+s(r.dataIndex)+'" data-index="'+s(l)+'" ref="selectRaw">'),d(r.store,function(e,t){c==e.key?o.push('<option value="'+s(e.key)+'" selected="">'+s(e.value)+"</option>"):o.push('<option value="'+s(e.key)+'">'+s(e.value)+"</option>")}),o.push("</select>"),this.$resolve(o)}})}),Simple.Module({name:"jxb:component/form/view/checkbox",require:[]},function(e,t,a,n){t.exports=n.View.create({id:t.id,isLoad:!0,component:{},events:{},include:[],tagName:"sp:each",media:[],style:[],template:function(e,t,a,n,i){"use strict";var o=[],s=this.$helpers,r=this.$each,l=e.v,d=(e.$value,e.$index,this.$escape),c=(e.arr,s.Simple),p=e.view,u=e.i;return r(l.store,function(e,t){o.push('<div class="col-xs-'+d(l.storeBox?l.storeBox:"3")+' checkbox-group"><div class="checkbox"><label>');var a=c.Tools.parse(""+(p[l.dataIndex]||l.value||l.key||"[]"));o.push('<span class="new-checkbox '+d(a.indexOf(e.key)>=0||a.indexOf(e.key+"")>=0?"active":"")+" "+d(l.disabled?"disabled":"")+'" name="'+d(l.dataIndex)+'" data-index="'+d(u)+'" value="'+d(e.key)+'"></span>'),l.disabled?a.indexOf(e.key)>=0||a.indexOf(e.key+"")>=0?o.push('<input type="checkbox" disabled="" ref="validateItemChk" name="'+d(l.dataIndex)+'" data-index="'+d(u)+'" value="'+d(e.key)+'" checked="">'):o.push('<input type="checkbox" disabled="" ref="validateItemChk" name="'+d(l.dataIndex)+'" data-index="'+d(u)+'" value="'+d(e.key)+'">'):a.indexOf(e.key)>=0||a.indexOf(e.key+"")>=0?o.push('<input type="checkbox" name="'+d(l.dataIndex)+'" ref="validateItemChk" data-index="'+d(u)+'" value="'+d(e.key)+'" checked="">'):o.push('<input type="checkbox" name="'+d(l.dataIndex)+'" ref="validateItemChk" data-index="'+d(u)+'" value="'+d(e.key)+'">'),o.push("<span>"+d(e.value)+"</span></label></div></div>")}),this.$resolve(o)}})}),Simple.Module({name:"jxb:component/form/view/radio",require:[]},function(e,t,a,n){t.exports=n.View.create({id:t.id,isLoad:!0,component:{},events:{},include:[],tagName:"div",media:[],style:[],template:function(e,t,a,n,i){"use strict";var o=[],s=this.$helpers,r=this.$each,l=e.v,d=(e.$value,e.$index,this.$escape),c=(e.val,e.view),p=s.Simple,u=(e.key,e.isActive,e.i);return r(l.store,function(e,t){o.push('<div class="col-xs-'+d(l.storeBox?l.storeBox:"3")+' radio-group"><div class="checkbox"><label>');var a=c[l.dataIndex];a=p.Tools.isUndef(a)?(l.value||l.key||"").toString():a.toString();var n=e.key+"",i=n===a;o.push('<span data-value="'+d(c[l.dataIndex])+'" class="new-radio '+d(i?"active":"")+" "+d(l.disabled?"disabled":"")+'" name="'+d(l.dataIndex)+'" data-index="'+d(u)+'" value="'+d(n)+'"></span>'),l.disabled?n===a?o.push('<input type="radio" class="" disabled="" name="'+d(l.dataIndex)+'" ref="validateItemChk" data-index="'+d(u)+'" value="'+d(n)+'" checked="">'):o.push('<input type="radio" class="" disabled="" name="'+d(l.dataIndex)+'" ref="validateItemChk" data-index="'+d(u)+'" value="'+d(n)+'">'):n===a?o.push('<input type="radio" class="" name="'+d(l.dataIndex)+'" ref="validateItemChk" data-index="'+d(u)+'" value="'+d(n)+'" checked="">'):o.push('<input type="radio" class="" name="'+d(l.dataIndex)+'" ref="validateItemChk" data-index="'+d(u)+'" value="'+d(n)+'">'),o.push("<span>"+d(e.value)+"</span></label></div></div>")}),this.$resolve(o)}})}),Simple.Module({name:"jxb:component/select/main",require:["./view/main"]},function(e,t,a,n){var i=e("./view/main");t.exports=n.Component.extend({$constructor:function(){this.$super(),this.state={searchInput:""}},isArray:function(e){return e instanceof Array},willMount:function(){},clear:function(){this.setState({indexs:[]})},formatIndexs:function(e){var t=this.props,a=t.selectedKey,n=t.data;return t.multiple?this.isArray(n)&&this.isArray(a)&&(e=[],n.forEach(function(t,n){a.forEach(function(a){t.key==a&&e.push(n)})})):a===undefined||t.multiple||(e=[],n&&n.forEach&&n.forEach(function(t,n){t.key==a&&""!==a&&e.push(n)})),e},didMount:function(){var e=this;e.event.on("select","click",function(t){if(!(t.refTarget.className.indexOf("disabled")>=0))return e.state.show||document.body.click(),e.setState({show:!e.state.show}),!1}),e.event.on("selectGroup","click",function(){return!1}),e.event.on("removeItem","click",function(t){var a=parseInt(t.refTarget.getAttribute("data-index")),n=e.formatIndexs(e.state.indexs),i={},o=e.props.data;return e.props.selectedKey="",n.splice(a,1),e.setState({indexs:n}),i[e.props.name]=function(e){var t=[];return e.forEach(function(e){t.push(o[e].key)}),JSON.stringify(t)}(n),e.props.multiple&&e.props.onChange&&e.props.onChange.call(e.parent,i,e.props,o,n),!1}),e.event.on("selectOption","click",function(t){var a=t.refTarget.getAttribute("data-status"),n=t.refTarget.getAttribute("data-key"),i=parseInt(t.refTarget.getAttribute("data-index")),o=e.formatIndexs(e.state.indexs||[]),s=e.props.data,r={};if(n){if("disabled"!==a)return e.props.multiple?(o.indexOf(i)>=0?o.splice(o.indexOf(i),1):o.push(i),r[e.props.name]=function(e){var t=[];return e.forEach(function(e){t.push(s[e].key)}),JSON.stringify(t)}(o),e.props.onChange&&e.props.onChange.call(e.parent,r,e.props,s,o),e.setState({searchInput:"",indexs:o})):(e.props.name&&e.props.onChange&&(r[e.props.name]=n,e.props.onChange.call(e.parent,r,e.props,s,i)),e.setState({indexs:[i],searchInput:"",show:!1})),!1}else e.setState({show:!1})}),e.event.on("remove","click",function(){e.props.selectedKey="",e.state.indexs=[],e.forceUpdate();var t={};return t[e.props.name]="",e.props.onChange&&e.props.onChange.call(e.parent,t,e.props),!1}),e.event.on(document.body,"click",function(t){if(!n.Tools.checkBodyClick(t.refTarget))return!1;e.state.show&&e.setState({show:!1})}),e.event.on("searchInput","input",function(t){e.setState({searchInput:t.refTarget.value})})},name:t.id,view:i})}),Simple.Module({name:"jxb:component/select/view/main",require:[]},function(e,t,a,n){t.exports=n.View.create({id:t.id,isLoad:!0,component:{},events:{},include:[],tagName:"div",media:[null],style:["./main"],template:function(e,t,a,n,i){"use strict";var o=[],s=(this.$helpers,e.props),r=e.self,l=e.state,d=e.data,c=e.placeholder,p=e.indexs,u=(e.selectedKey,this.$escape),m=(e.key,e.value,this.$each),h=(e.$value,e.$index,e.arr);s=r.props,l=r.state,d=s.data,c=s.placeholder,p=l.indexs||[],s.selectedKey;(p=r.formatIndexs(p),o.push('<div class="dropdown my-select '+u(p[0]>=0?"has-data":"placeholder")+'">'),r.isArray(d)&&p)&&(0===d.length&&(r.parent.isForm&&(s.disabled=!0),p=[],d[0]={key:"",value:"\u6682\u65e0\u6570\u636e"}),o.push('<div class="mybtn form-control '+u(l.show?" hover":"")+" "+u(s.disabled?"disabled":"")+" "+u(s.multiple?"multiple":"")+'" type="button" ref="select">'),p[0]>=0?s.multiple?m(p,function(e,t){o.push('<span class="my-sel-mul-name" key="a'+u(t)+'">'+u(d[e].value)+'<i ref="removeItem" data-index="'+u(t)+'"></i></span>')}):o.push('<span class="my-sel-chk-name">'+u(d[p[0]].value,["script"])+"</span>"):o.push('<span class="my-sel-chk-name">'+u(c,["script"])+"</span>"),o.push('<span class="mycaret" skip="true"></span>'),s.disabled||s.multiple||o.push('<span class="glyphicon glyphicon-remove my-sel-remove" ref="remove" skip="true"></span>'),o.push('</div><div class="dropdown-menu-g '+u(l.show?" show":"")+'" ref="selectGroup">'),s.search&&o.push('<div class="dw-search-input"><input type="text" class="form-control" placeholder="\u641c\u7d22" ref="searchInput" skip="true"></div>'),o.push('<ul class="dropdown-menu2">'),m(h=d,function(e,t){o.push('<li class="'+u(e.disabled?"disabled":"")+" "+u(!l.searchInput||(e.value+"").indexOf(l.searchInput)>=0?"":"hide")+'" ref="selectOption" data-index="'+u(t)+'" data-status="'+u(e.disabled?"disabled":"")+'" data-key="'+u(e.key)+'"><a class="'+u(p.indexOf(t)>=0?"my-active":"")+'">'),s.multiple&&e.key!==undefined?o.push('<span class="new-checkbox '+u(p.indexOf(t)>=0?"active":"")+'">'+u(e.value)+"</span>"):o.push(""+u(e.value)),o.push("</a></li>")}),0===h.length&&o.push('<li class="dw-search-nodata" skip="true"><a>\u6682\u65e0\u6570\u636e</a></li>'),o.push("</ul></div>"));return o.push("</div>"),this.$resolve(o)}})}),Simple.Module({name:"jxb:component/upload/main",require:["./view/main"]},function(e,t,a,n){var i=e("./view/main");t.exports=n.Component.extend({$constructor:function(){this.$super(),this.state={status:[],image:[],error:[]},this.props={}},uploadImg:function(e,t){var a=this,i=(a.props.store,a.props.maxSize||10);if(e.name.match(/\.(jpg|png|jpeg|bmp)$/i))if(e.size/1024/1024>i)n.Dialog.toast("\u6587\u4ef6\u4e0d\u80fd\u5927\u4e8e"+i+"MB");else{var o=new FormData;o.append("file",e),o.append("bucket","jiaxiaozhijia"),o.append("name",e.name),o.append("type",a.props.type||"image"),xhr=new XMLHttpRequest,xhr.open("post","https://upload-image.kakamobi.cn/api/open/admin-upload.htm",!0),xhr.onreadystatechange=function(){if(200===this.status&&4===this.readyState){var e=JSON.parse(this.responseText),n=a.state.status,i=a.state.image;if(n[t]="loaded",i[t]=e.data[0].url,a.state.moreDataImage.push(e.data[0]),a.setState({status:n,image:i}),a.props.onUpload){var o={};a.props.multiple?a.props.moreData?o[a.props.dataName]=JSON.stringify(a.state.moreDataImage):o[a.props.dataName]=JSON.stringify(i):a.props.moreData?o[a.props.dataName]=JSON.stringify(e.data):(o[a.props.dataName]=e.data[0].url,o[a.props.fileName]=e.data[0].fileName),a.props.onUpload.call(a.parent,o)}}},xhr.onerror=function(){var e=a.state.status;e[t]="error",a.setState({status:e})},xhr.upload.onprogress=function(e){var n=a.state.status;n[t]=parseInt(e.loaded/e.total*100)+"%",a.setState({status:n})},xhr.upload.onloadstart=function(){var e=a.state.status;e[t]="starting",a.setState({status:e})},xhr.send(o)}else n.Dialog.toast("\u6587\u4ef6\u683c\u5f0f\u53ea\u80fd\u4e3ajpeg\uff0cjpg\uff0cpng\u548cbmp\u683c\u5f0f")},clear:function(){this.setState({fileName:"",image:[],moreDataImage:[],status:[],error:[]})},uploadFile:function(e){var t=this,a=t.props.store,i="https://upload-image.kakamobi.cn/api/open/admin-upload.htm",o=t.props.maxSize||5;a&&(i=n.Store.getHosts().client.jxb+"api/open/admin/file/upload.htm");t.props.accept;if(e.size/1024/1024>o)n.Dialog.toast("\u6587\u4ef6\u4e0d\u80fd\u5927\u4e8e"+o+"MB");else{var s=new FormData;s.append("file",e),s.append("bucket","jiaxiaozhijia"),s.append("name",e.name),s.append("type","file"),xhr=new XMLHttpRequest,xhr.open("post",i,!0),xhr.onload=function(){var n=JSON.parse(xhr.responseText);if(a?t.setState({status:"loaded",fileName:e.name}):t.setState({status:"loaded",image:n.data[0].url}),t.props.onUpload){var i={};a?(i.uuid=n.data.uuid,t.props.onUpload.call(t.parent,i)):(i[t.props.dataName]=n.data[0].url,i[t.props.fileName]=e.name,t.props.onUpload.call(t.parent,i))}},xhr.onerror=function(){t.setState({status:"error"})},xhr.upload.onprogress=function(e){t.setState({status:parseInt(e.loaded/e.total*100)+"%"})},xhr.upload.onloadstart=function(){t.setState({status:"starting"})},xhr.send(s)}},willMount:function(){this.willReceiveProps(this.props)},willReceiveProps:function(e){var t,a,i=this.parent.state.view[e.dataName];e.multiple?i&&(i=JSON.parse(i),this.setState({image:(t=i,a=[],e.moreData&&t.forEach(function(e,t){a.push(e.url)}),e.moreData?a:t),status:function(e){var t=[];return i.forEach(function(e,a){t.push("loaded")}),t}()})):(this.props.moreData&&i&&(i=n.Tools.parse(i)[0].url),i&&this.setState({image:[i],status:["loaded"]}))},didMount:function(e){var t=this;t.state.moreDataImage=t.props.url||[],t.event.on("file","change",function(e){var a=t.state.image.length,i=e.refTarget.files,o=t.props.max||10,s=t.props.multiple;"xls"===t.props.accept?t.uploadFile(i[0]):n.Utils.each(i,function(e,n){var i=n+a;i<o&&t.uploadImg(e,s?i:0)})}),t.event.on("cha","click",function(e){var a=parseInt(e.refTarget.getAttribute("data-index")),n=t.state.status,i=t.state.image,o=t.state.error;if(n.splice(a,1),i.splice(a,1),o.splice(a,1),t.state.moreDataImage.splice(a,1),t.setState({status:n,image:i,error:o}),t.props.onUpload){var s={};t.props.multiple&&(t.props.moreData?s[t.props.dataName]=JSON.stringify(t.state.moreDataImage):s[t.props.dataName]=JSON.stringify(i)),t.props.onUpload.call(t.parent,s)}return!1}),t.event.on("btn","click",function(){e.file.click()})},view:i,name:t.id}),t.exports.setName(t.id)}),Simple.Module({name:"jxb:component/upload/view/main",require:[]},function(e,t,a,n){t.exports=n.View.create({id:t.id,isLoad:!0,component:{},events:{},include:[],tagName:"div",media:[null],style:["./main"],template:function(e,t,a,n,i){"use strict";var o=[],s=(this.$helpers,e.props),r=e.self,l=e.state,d=e.type,c=(e.name,e.accept),p=e.max,u=e.fileName,m=e.filePath,h=this.$escape,f=this.$each;e.$value,e.$index,s=r.props||{},l=r.state||{},d=s.type||"image",c="image"===d?"image/*":"video/*",p=r.props.max||5;s.btnText&&s.btnText;u=r.parent.state.view[s.fileName],m=r.parent.state.view[s.dataName];return l.fileName&&(u=l.fileName),o.push('<div class="upload-container">'),"xls"!==s.accept?s.multiple?(o.push('<input type="file" name="file" class="hide" multiple="multiple" ref="file" accept="'+h(c)+'">'),f(l.status,function(e,t){o.push('<div class="file-g" ref="btn" style="background-image:url('+h(l.image[t])+')">'),"loaded"!==e&&o.push('<div class="fg">'+h(e)+"</div>"),o.push('<span class="cha" ref="cha" data-index="'+h(t)+'">\xd7</span></div>')}),o.push('<div class="btn-add '+h(l.image.length>=p?"hide":"")+'" ref="btn"></div>')):(o.push('<input type="file" name="file" class="hide" ref="file" accept="'+h(c)+'">'),l.status[0]?(o.push('<div class="file-g single" style="background-image:url('+h(l.image[0])+')" ref="btn">'),"loaded"!==l.status[0]&&o.push('<div class="fg">'+h(l.status[0])+"</div>"),o.push("</div>")):o.push('<div class="btn-add" ref="btn" skip="true"></div>'),!1!==s.showDesc&&o.push('<div class="upload-tip">'+h(s.desc?"1. ":"")+"\u4e0a\u4f20\u7684\u6587\u4ef6\u9650"+h(s.maxSize||10)+'M\u4ee5\u5185\uff0cjpeg\uff0cjpg\uff0cpng\u548cbmp\u7b49\u56fe\u7247\u6587\u4ef6\u683c\u5f0f<br skip="true">'+h(s.desc,["script"])+"</div>")):(o.push('<input type="file" name="file" ref="file" class="hide" accept="application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" skip="true"><button class="btn btn-primary mr20" ref="btn">\u9009\u62e9\u6587\u4ef6'+h("")+"</button>"),u&&o.push('<a class="link-up" href="'+h(m)+'" download="'+h(u)+'">'+h(u)+"</a>")),o.push("</div>"),this.$resolve(o)}})}),Simple.Module({name:"jxb:component/upload-cut/main",require:["./view/main"]},function(e,t,a,n){var i=e("./view/main");t.exports=n.Component.extend({$constructor:function(){this.$super(),this.state={},this.props={}},didUpdate:function(){},uploadImg:function(e){var t=this,a=(t.props.store,t.props.maxSize||2);if(e.name.match(/\.(jpg|png|jpeg|bmp)$/i))if(e.size/1024/1024>a)n.Dialog.toast("\u6587\u4ef6\u4e0d\u80fd\u5927\u4e8e"+a+"MB");else{var i=new FormData;i.append("file",e),i.append("bucket","jiaxiaozhijia"),i.append("name",e.name),i.append("type",t.props.type||"image"),xhr=new XMLHttpRequest,xhr.open("post","https://upload-image.kakamobi.cn/api/open/admin-upload.htm",!0),xhr.onload=function(){var e=JSON.parse(xhr.responseText);if(t.setState({status:"loaded",image:e.data[0].url}),t.props.onUpload){var a={};a[t.props.dataName]=e.data[0].url,a[t.props.fileName]=e.data[0].fileName,t.props.onUpload.call(t.parent,a)}},xhr.onerror=function(){t.setState({status:"error"})},xhr.upload.onprogress=function(e){t.setState({status:parseInt(e.loaded/e.total*100)+"%"})},xhr.upload.onloadstart=function(){t.setState({status:"starting"})},xhr.send(i)}else n.Dialog.toast("\u6587\u4ef6\u683c\u5f0f\u53ea\u80fd\u4e3ajpeg\uff0cjpg\uff0cpng\u548cbmp\u683c\u5f0f")},clear:function(){this.setState({fileName:""})},didMount:function(e){var t=this;t.event.on("btn","click",function(){n.plugin.tailorImg({imgStyle:"4*3",callback:function(e){if(t.setState({status:"loaded",image:e.url}),t.props.onUpload){var a={};a[t.props.dataName]=e.url,a[t.props.fileName]=e.fileName,t.props.onUpload.call(t.parent,a)}}})})},view:i,name:t.id}),t.exports.setName(t.id)}),Simple.Module({name:"jxb:component/upload-cut/view/main",require:[]},function(e,t,a,n){t.exports=n.View.create({id:t.id,isLoad:!0,component:{},events:{},include:[],tagName:"div",media:[null],style:["./main"],template:function(e,t,a,n,i){"use strict";var o=[],s=(this.$helpers,e.props),r=e.self,l=e.state,d=(e.type,e.name,e.accept,e.show),c=e.url,p=(e.fileName,this.$escape);s=r.props||{},l=r.state||{},s.type,d=s.show;s.btnText&&s.btnText;c=r.parent.state.view[s.dataName],r.parent.state.view[s.fileName];return c&&(l.status="loaded"),l.image&&(c=l.image),s.show&&(c=d),l.fileName&&l.fileName,o.push('<div class="upload-cut-container">'),l.status?(o.push('<div class="file-g" style="background-image:url('+p(c)+')" ref="btn">'),"loaded"!==l.status&&o.push('<div class="fg">'+p(l.status)+"</div>"),o.push("</div>")):o.push('<div class="btn-add" ref="btn" skip="true"></div>'),!1!==s.showDesc&&o.push('<div class="upload-tip">'+p(s.desc?"1. ":"")+"\u4e0a\u4f20\u7684\u6587\u4ef6\u9650"+p(s.maxSize||2)+'M\u4ee5\u5185\uff0cjpeg\uff0cjpg\uff0cpng\u548cbmp\u7b49\u56fe\u7247\u6587\u4ef6\u683c\u5f0f<br skip="true">'+p(s.desc,["script"])+"</div>"),o.push("</div>"),this.$resolve(o)}})}),Simple.Module({name:"jxb:component/select-input/main",require:["./view/main"]},function(e,t,a,n){var i=e("./view/main");t.exports=n.Component.extend({$constructor:function(){this.$super(),this.state={select:"",selectData:[],list:[],show:!1}},willMount:function(){this.setState({list:this.props.data,select:this.props.value||""})},isChinese:function(e){return!!/^[\u3220-\uFA29]+$/.test(e)},getRex:function(e){for(var t=e.split(""),a="",n=0;n<t.length;n++){var i=t[n];a+=0===n?"^"+i:"[a-z]{0,}"+i}return new RegExp(a)},selectChanged:function(){var e=this.state,t=[];if(e.select)if(this.isChinese(e.select))for(var a=0;a<e.list.length;a++){(n=e.list[a]).name.indexOf(e.select)>-1&&t.push(n)}else for(a=0;a<e.list.length;a++){var n=e.list[a];this.getRex(e.select).test(n.pinyin)&&t.push(n)}this.setState({searchData:t})},didMount:function(){var e=this;e.event.on("selectInput","click",function(t){e.setState({show:!0},!0),t.stopPropagation()}),e.event.on("selectInput","change",function(t){e.props.onBlur&&e.props.onBlur.call(e.parent,e.props.name)}),e.event.on("selectInput","input",function(t){var a=t.refTarget.value;e.setState({select:a,show:!0},!0),e.selectChanged(),e.props.onChange&&e.props.onChange.call(e.parent,a)}),e.event.on("switchOption","click",function(t){var a=t.refTarget.getAttribute("data-index"),n=e.state.searchData[a];e.setState({select:n.name,key:n.code,show:!1}),e.props.onChange&&e.props.onChange.call(e.parent,n,e.props.list)}),e.event.on(document.body,"click",function(t){e.state.show&&e.setState({show:!1})})},name:t.id,view:i})}),Simple.Module({name:"jxb:component/select-input/view/main",require:[]},function(e,t,a,n){t.exports=n.View.create({id:t.id,isLoad:!0,component:{},events:{},include:[],tagName:"div",media:[null],style:["./main"],template:function(e,t,a,n,i){"use strict";var o=[],s=(this.$helpers,e.props),r=e.self,l=e.state,d=(e.data,e.placeholder),c=e.select,p=e.name,u=this.$escape,m=this.$each;e.$index,s=r.props,l=r.state,s.data,d=s.placeholder,c=l.select,p=s.name;return o.push('<div class="select-container"><input type="text" name="'+u(p||"select-input")+'" class="select-input form-control" placeholder="'+u(d||"\u8bf7\u8f93\u5165\u4e2d\u6587\u6216\u62fc\u97f3")+'" value="'+u(c)+'" ref="selectInput"><ul class="select-input-wrap '+u(!l.show&&"hide")+'">'),m(l.searchData,function(e,t){o.push('<li ref="switchOption" data-index="'+u(t)+'"><span>'+u(e.name)+"</span></li>")}),o.push("</ul></div>"),this.$resolve(o)}})}),Simple.Module({name:"jxb:component/fankui/main",require:["./view/main"]},function(e,t,a,n){var i=e("./view/main");t.exports=n.Component.extend({$constructor:function(){this.$super(),this.state={config:{store:{save:"jxb://api/open/admin/feedback/create.htm"},columns:[{header:"\u53cd\u9988\u7c7b\u578b",dataIndex:"type",placeholder:"\u53cd\u9988\u7c7b\u578b",xtype:"radio",key:"1",store:[{key:"1",value:"\u9700\u6c42"},{key:"2",value:"\u5efa\u8bae"},{key:"3",value:"\u95ee\u9898"},{key:"4",value:"\u5408\u4f5c\u610f\u5411"}]},{header:"\u624b\u673a\u53f7\u7801",dataIndex:"phone",xtype:"text",required:"phone",placeholder:"\u8bf7\u8f93\u5165\u60a8\u7684\u624b\u673a\u53f7\u7801"},{header:"\u53cd\u9988\u5185\u5bb9",dataIndex:"content",xtype:"textarea",rows:5,maxlength:200,required:!0,placeholder:"\u8bf7\u8f93\u5165\u60a8\u7684\u53cd\u9988\uff0c\u6211\u4eec\u4f1a\u53ca\u65f6\u4e0e\u60a8\u8054\u7cfb"}]}}},show:function(){this.children.Dialog.show({title:"\u53cd\u9988",onConfirm:function(){var e=this;e.children.Form.save().done(function(){n.Dialog.toast("\u53cd\u9988\u6210\u529f"),e.hide()})}})},didMount:function(e){},name:t.id,view:i})}),Simple.Module({name:"jxb:component/fankui/view/main",require:["jxb:component/dialog/main","jxb:component/form/main"]},function(e,t,a,n){t.exports=n.View.create({id:t.id,isLoad:!0,component:{Dialog:e("jxb:component/dialog/main"),Form:e("jxb:component/form/main")},events:{},include:[],tagName:"div",media:[],style:[],template:function(e,t,a,n,i){"use strict";var o=this,s=[],r=(this.$helpers,e.state),l=e.self,d=function(){return o.$component(arguments,a)};r=l.state;return s.push('<div class="fankui-dialog">'),s.push(d("(Dialog)Dialog.0",{name:"Dialog"},function(){var e=[];return e.push(d("Form.0",{config:r.config},null,"(Dialog)Dialog.0")),e}(),i)),s.push("</div>"),o.$resolve(s)}})}),Simple.Module({name:"jxb:component/update-pwd/main",require:["./view/main"]},function(e,t,a,n){var i=e("./view/main");t.exports=n.Component.extend({$constructor:function(){this.$super(),this.state={}},getConfig:function(e){return{store:{load:!0,save:"bd://api/auth/forgot-password-verify-sms.htm"},data:{phoneNumber:e},onBeforeSend:function(e){return e.checkType=!0,e.smsId?e:(n.Dialog.alert("\u8bf7\u5148\u83b7\u53d6\u9a8c\u8bc1\u7801"),!1)},columns:[{xtype:"hidden",show:!1,dataIndex:"captchaId"},{xtype:"hidden",show:!1,dataIndex:"smsId"},{header:"\u624b\u673a\u53f7",dataIndex:"phoneNumber",placeholder:"\u8bf7\u8f93\u5165\u60a8\u767b\u5f55\u7684\u624b\u673a\u53f7\u7801",xtype:"text",required:"phone",disabled:!!e},{header:"\u65b0\u5bc6\u7801",dataIndex:"password",placeholder:"\u65b0\u5bc6\u7801",xtype:"password",required:!0},{header:"\u56fe\u7247\u9a8c\u8bc1\u7801",placeholder:"\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801",dataIndex:"captchaCode",xtype:"define",ready:function(){var e=this,t=e.getDOMNode(),a=function(){n.request("bd://api/auth/forgot-password-captcha.htm").done(function(a){e.state.view.captchaId=a.captchaId,t.imgYzm.src=a.captchaUrl})};e.event.on("imgYzm","click",function(){a()}),e.event.on("uwCode","input",function(t){e.state.view.captchaCode=t.refTarget.value,e.setState({})}),a()},render:function(e){return'<input type="text" maxlength="6" value="'+(e.captchaCode||"")+'" class="form-control uw-code" ref="uwCode"/><img skip="true" class="uw-code-img" ref="imgYzm" src=""/>'},required:!0},{header:"\u77ed\u4fe1\u9a8c\u8bc1\u7801",placeholder:"\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801",dataIndex:"smsCode",xtype:"define",ready:function(){var e=this,t=e.getDOMNode(),a=e.state.view;e.event.on("dxYzm","input",function(t){e.state.view.smsCode=t.refTarget.value,e.setState({})}),e.event.on("send","click",function(){e.validate("phone")&&e.validate("captchaCode")&&n.request("bd://api/auth/forgot-password-check.htm",{checkType:!0,phoneNumber:a.phoneNumber,captchaId:a.captchaId,captchaCode:a.captchaCode},"post").done(function(e){var n,i=60,o=function(){if(i<=0)return clearInterval(n),t.send.removeAttribute("disabled"),void(t.send.innerHTML="\u70b9\u51fb\u83b7\u53d6");t.send.innerHTML=i+"s",i--};t.send.setAttribute("disabled","true"),a.smsId=e.smsId,n=setInterval(o,1e3),o()})})},render:function(e){return'<input type="text" maxlength="6" value="'+(e.smsCode||"")+'" class="form-control uw-code" ref="dxYzm"/><button skip="true" ref="send" type="button" class="btn btn-primary">\u70b9\u51fb\u83b7\u53d6</button>'},required:!0}]}},show:function(e){e=e||{},this.setState({config:this.getConfig(e.phone)},!0),this.children.MyDialog.show({width:500,title:e.title||"\u8bbe\u7f6e\u5bc6\u7801",showCancel:!1,confirmText:"\u4fdd\u5b58",onConfirm:function(){var e=this,t=e.children.MyForm,a=JSON.parse(JSON.stringify(t.state.view));t.save().done(function(t){a.smsToken=t.smsToken,e.hide(),n.request("bd://api/auth/forgot-password-submit.htm",a,"post").done(function(e){n.Tools.setStorage("userInfo",e),n.Dialog.alert({content:"\u4fee\u6539\u6210\u529f"})})})}})},didMount:function(e){},name:t.id,view:i})}),Simple.Module({name:"jxb:component/update-pwd/view/main",require:["../../dialog/main","../../form/main"]},function(e,t,a,n){t.exports=n.View.create({id:t.id,isLoad:!0,component:{MyDialog:e("../../dialog/main"),MyForm:e("../../form/main")},events:{},include:[],tagName:"div",media:[null],style:["./main"],template:function(e,t,a,n,i){"use strict";var o=this,s=[],r=(this.$helpers,e.state),l=e.self,d=function(){return o.$component(arguments,a)};r=l.state;return s.push('<div class="update-pwd-container">'),s.push(d("MyDialog.0",{},function(){var e=[];return r.config&&e.push(d("MyForm.0",{config:r.config},null,"MyDialog.0")),e}(),i)),s.push("</div>"),o.$resolve(s)}})}),Simple.Module({name:"jxb:component/login/main",require:["./view/main"]},function(e,t,a,n){var i=e("./view/main");t.exports=n.Component.extend({$constructor:function(){var e=location.href.replace(/(\?|#).*$/gi,"").replace(/(index|login)\.html/gi,"")+"login.html";n.develop&&(e+="?develop=true"),this.$super(),this.loginUrl=n.Store.getHosts().client.ph+"api/sso/user/sso-login.htm?backUrl="+encodeURIComponent(e),this.state={show:!1,animate:!1,loginUrl:this.loginUrl}},didMount:function(){var e=this;e.event.on(window,"message",function(t){"new-marketing-pingxing-com-login-success"===t.data?(e.emit("login-success"),e.setState({loginUrl:null})):"string"==typeof t.data&&0===t.data.indexOf("alert")?n.Container.alert(t.data.replace("alert",""),"- \u767b\u5f55\u5931\u8d25 -"):"string"==typeof t.data&&0===t.data.indexOf("download")&&n.Container.message(t.data.replace("download",""),"- \u767b\u5f55\u5931\u8d25 -","\u53bb\u4e0b\u8f7d",function(){window.location="http://www.pingxing.cn/a_download/"})})},show:function(e){var t=this;t.once("login-success",function(){e&&e(),t.setState({show:!1})}),t.setState({show:!0,animate:!0,loginUrl:t.loginUrl})},name:t.id,view:i})}),Simple.Module({name:"jxb:component/login/view/main",require:[]},function(e,t,a,n){t.exports=n.View.create({id:t.id,isLoad:!0,component:{},events:{},include:[],tagName:"com-login",media:[null,null],style:["common:css/main","./main"],template:function(e,t,a,n,i){"use strict";var o=[],s=(this.$helpers,e.props,e.self),r=e.state,l=this.$escape;s.props,r=s.state;return o.push('<com-login class="'+l(r.show?"show":"hide")+" "+l(r.animate?"animate":"")+'"><div class="home-top" skip="true"><logo></logo><div class="home-top-link"><a href="http://share.m.kakamobi.com/activity.kakamobi.com/pingxingzhijia-pc-show/?shareProduct=pingxingzhijia&shareKey=pingxingzhijia-pc-show&placeKey=pingxingzhijia-pc-show" data-ref="jump" target="_blank">\u5173\u4e8e\u6211\u4eec</a><span>&nbsp;\xb7&nbsp;</span><a href="http://share.m.kakamobi.com/activity.kakamobi.com/pingxingzhijia-pc-show/about.html" data-ref="jump" target="_blank">\u5408\u4f5c</a></div></div><div class="home-content"><div class="home-content-pic" skip="true"></div><div class="home-content-login"><label skip="true">\u8d26\u53f7\u767b\u5f55</label>'),r.loginUrl&&r.show&&o.push('<iframe src="'+l(r.loginUrl)+'"></iframe>'),o.push("</div></div></com-login>"),this.$resolve(o)}})}),Simple.Module({name:"jxb:component/sidebar/main",require:["./view/main"]},function(e,t,a,n){var i=e("./view/main");t.exports=n.Component.extend({$constructor:function(){this.$super(),this.state={active:"",tabIndex:"",tabs:[],navigation:[]}},convertRoleData:function(e){var t={};return e.jobTitlePermission.moduleList.forEach(function(e,a){e.permissionList.forEach(function(e){t[e.permissionName]=e.checked})}),t},isManager:function(){return!!this.props.roleInfo.cJiaxiaoAdmin},getNav:function(e,t,a,i,o){var s=[{name:"",list:[{href:"/dashboard/",icon:"s1",name:"\u9996\u9875"},{href:n.MyHost.bxUrl,icon:"s2",no:!0,show:this.isManager(),name:"\u4fdd\u9669\u5546\u57ce"},{href:"/clue/index/",icon:"s3",show:this.isManager(),name:"\u67e5\u770b\u7ebf\u7d22"},{name:"\u9a7e\u6821\u4f1a\u5458",icon:"svip",show:this.isManager(),list:[{href:"/vip/vip-invest/",name:"\u8d2d\u4e70\u4f1a\u5458"},{href:"/vip/vip-log/",name:"\u6211\u7684\u4f1a\u5458"}]}]},{show:this.isManager(),name:"\u8425\u9500",list:[{name:"\u9a7e\u8003\u5c55\u793a",icon:"s4",hot:!!(t||a||i),list:[{href:"/jiakao-display/basic-info/",name:"\u57fa\u672c\u4fe1\u606f",hot:t},{href:"/jiakao-display/class-info/",name:"\u73ed\u578b\u4fe1\u606f",hot:a},{href:"/jiakao-display/site-info/",name:"\u573a\u5730\u4fe1\u606f",hot:i},{href:"/jiakao-display/notice-manage/",name:"\u516c\u544a\u7ba1\u7406"},{href:"/jiakao-display/car-path/",name:"\u73ed\u8f66\u8def\u7ebf"},{href:"/jiakao-display/pic-manage/",name:"\u56fe\u7247\u7ba1\u7406"}]},{name:"\u62db\u751f\u5de5\u5177",icon:"s5",href:"/recruit/index/"},{name:"\u53e3\u7891\u7ba1\u7406",icon:"s6",href:"/market/public-praise/"}]},{name:"\u4eba\u5458",list:[{name:"\u5b66\u5458\u7ba1\u7406",icon:"s7",list:[{href:"/student/apply/",name:"\u62a5\u540d\u767b\u8bb0"},{href:"/student/student-list/",name:"\u5b66\u5458\u5217\u8868"},{href:"/student/student-graduate-list/",name:"\u6bd5\u4e1a\u5b66\u5458\u5217\u8868"},{href:"/student/approve/",name:"\u5ba1\u6279\u7ba1\u7406"},{href:"/student/change-shifts/",name:"\u6362\u73ed\u7ba1\u7406"},{href:"/student/drop-out/",name:"\u9000\u5b66\u7ba1\u7406"},{href:"/student/five-no-pass/",name:"\u4e94\u6b21\u4e0d\u8fc7"}]},{name:"\u6559\u7ec3\u7ba1\u7406",icon:"s8",list:[{href:"/coach/coach-list/",name:"\u6559\u7ec3\u5217\u8868"},{href:"/coach/leave-manage/",name:"\u8bf7\u5047\u7ba1\u7406"},{href:"/coach/replace-coach/",name:"\u66ff\u73ed\u6559\u7ec3\u7ba1\u7406"}]}]},{name:"\u57f9\u8bad",list:[{name:"\u5206\u8f66\u7ba1\u7406",icon:"s9",list:[{href:"/allot-car/subject2/",name:"\u79d1\u4e8c\u5b66\u5458\u5206\u8f66"},{href:"/allot-car/subject3/",name:"\u79d1\u4e09\u5b66\u5458\u5206\u8f66"},{href:"/allot-car/detail/",name:"\u5206\u8f66\u660e\u7ec6"}]},{name:"\u8bc4\u4ef7\u7ba1\u7406",icon:"s10",href:"/market/dianping-mange/"},{name:"\u7ea6\u8bfe\u7ba1\u7406",icon:"s11",list:[{href:"/order/order-manage/",name:"\u7ea6\u8bfe\u7ba1\u7406"},{href:"/order/order-detail/",name:"\u7ea6\u8bfe\u660e\u7ec6"},{href:"/order/hour-manage/",name:"\u8bfe\u65f6\u7ba1\u7406"}]}]},{name:"\u8003\u8bd5",list:[{name:"\u8003\u8bd5\u7ba1\u7406",icon:"s12",list:[{href:"/exam-manager/yuyue/",name:"\u7ea6\u8003\u63d0\u9192"},{href:"/exam-manager/kaoshi/",name:"\u8003\u8bd5\u7ba1\u7406"}]}]},{name:"\u7edf\u8ba1",list:[{name:"\u8d22\u52a1\u7ba1\u7406",icon:"s13",list:[{href:"/finance-manager/list/",name:"\u6536\u652f\u5f55\u5165"},{href:"/finance-manager/project/",name:"\u6536\u652f\u9879\u76ee\u8bbe\u7f6e"},{href:"/finance-manager/statistic/",name:"\u8d22\u52a1\u7edf\u8ba1"},{href:"/finance-manager/arrearage-student/",name:"\u6b20\u8d39\u5b66\u5458\u540d\u5355"}]},{name:"\u7edf\u8ba1\u62a5\u8868",icon:"s14",list:[{href:"/statement/apply-statement/",name:"\u62a5\u540d\u7edf\u8ba1"},{href:"/statement/coach-train-statement/",name:"\u6559\u7ec3\u57f9\u8bad\u7edf\u8ba1"},{href:"/statement/exam-statement/",name:"\u8003\u8bd5\u7edf\u8ba1"}]}]},{name:"\u57fa\u7840\u4fe1\u606f",list:[{name:"\u9a7e\u6821\u7ba1\u7406",icon:"s15",hot:Boolean(o),list:[{href:"/driving-school/campus-manage/",name:"\u6821\u533a\u7ba1\u7406"},{href:"/driving-school/auth-infomation/",name:"\u8ba4\u8bc1\u4fe1\u606f",hot:Boolean(o)},{href:"/driving-school/exam-room-manage/",name:"\u8003\u573a\u7ba1\u7406"},{href:"/driving-school/apply-address-manage/",name:"\u62a5\u540d\u70b9\u7ba1\u7406"},{href:"/driving-school/training-ground-manage/",name:"\u8bad\u7ec3\u573a\u7ba1\u7406"},{href:"/driving-school/class-type-manage/",name:"\u73ed\u578b\u7ba1\u7406"}]},{name:"\u4eba\u4e8b\u7ba1\u7406",icon:"s16",list:[{href:"/personnel/staff-manage/",name:"\u5458\u5de5\u7ba1\u7406"},{href:"/personnel/position-manage/",name:"\u804c\u4f4d\u7ba1\u7406"},{href:"/personnel/jurisdiction-allot/",name:"\u6743\u9650\u5206\u914d"},{href:"/personnel/business-inviters/",name:"\u62db\u751f\u7ecf\u529e\u4eba"}]},{name:"\u8f66\u8f86\u7ba1\u7406",icon:"s17",list:[{href:"/car-manage/car-list/",name:"\u8f66\u8f86\u7ba1\u7406"},{href:"/car-manage/drive-class/",name:"\u8f66\u578b\u7ba1\u7406"}]},{name:"\u7cfb\u7edf\u8bbe\u7f6e",icon:"s18",list:[{href:"/system/print-set/",name:"\u6253\u5370\u8bbe\u7f6e"},{href:"/system/switch-set/",name:"\u5f00\u5173\u8bbe\u7f6e"},{href:"/system/student-source-set/",name:"\u62db\u751f\u6765\u6e90\u8bbe\u7f6e"},{href:"/system/operation-log/",name:"\u64cd\u4f5c\u65e5\u5fd7"}]},{name:"other",show:!1,list:[{href:"/student/student-view/",name:"\u5b66\u5458\u4fe1\u606f\u8be6\u60c5"},{href:"/coach/coach-detail/",name:"\u6559\u7ec3\u4fe1\u606f\u8be6\u60c5"},{href:"/coach/coach-cost-detail/",name:"\u6559\u7ec3\u8d39\u7528\u8be6\u60c5"},{href:"/car-manage/car-cost-detail/",name:"\u8f66\u8f86\u6536\u652f\u8be6\u60c5"},{href:"/system/message/",name:"\u6d88\u606f\u63d0\u9192"},{href:"/driving-school/training-cost-detail/",name:"\u8bad\u7ec3\u573a\u6536\u652f\u5f55\u5165"},{href:"/recruit/activity/",name:"\u53d1\u5e03\u6d3b\u52a8"},{href:"/recruit/poster/",name:"\u6d77\u62a5\u5217\u8868"},{href:"/recruit/publish/lottery/",name:"\u53d1\u5e03\u62bd\u5956"},{href:"/recruit/act-stat/",name:"\u6d3b\u52a8\u7edf\u8ba1"},{href:"/recruit/publish/free/",name:"\u514d\u8d39\u8bd5\u5b66"},{href:"/recruit/publish/preference/",name:"\u9650\u65f6\u7279\u60e0"},{href:"/recruit/publish/group-buying/",name:"\u56e2\u8d2d\u5b66\u8f66"},{href:"/recruit/publish/success/",name:"\u6d3b\u52a8\u9884\u89c8"},{href:"/dashboard/effic/wx/",name:"\u5fae\u4fe1\u7ea6\u8bfe"},{href:"/dashboard/effic/down-app/",name:"APP\u767b\u5f55\u4ecb\u7ecd\u9875"},{href:"/clue/clue-his/",name:"\u7ebf\u7d22\u63a8\u9001\u5386\u53f2"},{href:"/dashboard/effic/bind-wx/",name:"\u5fae\u4fe1\u7ed1\u5b9a"},{href:"/dashboard/effic/syxs/",name:"\u5546\u4e1a\u8be2\u4ef7"}]}]}],r=this.convertRoleData(e);return s=s.filter(function(e){var t=e.list.filter(function(e){return"\u4fdd\u9669\u5546\u57ce"===e.name||"\u67e5\u770b\u7ebf\u7d22"===e.name||"\u9a7e\u6821\u4f1a\u5458"===e.name||!1===e.show||(e.list?e.list.filter(function(e){return r[e.name]}).length>0:!!e.href&&r[e.name])});return e.list=t,t.length>0}),this.state.navigation=s,s},findKey:function(e){var t=!1;return n.Tools.tabs.forEach(function(a){a.name===e?(t=!0,a.active=!0):a.active=!1}),t},getNameByHas:function(e){var t="",a="";return this.state.navigation.forEach(function(n,i){n.list.forEach(function(n,o){n.href===e&&(t=n.name),n.list&&n.list.forEach(function(n){n.href===e&&(t=n.name,a=i+"-"+o)})})}),[t,a]},init:function(e,t,a,i){var o=this.state.validateArr;o&&(e=o[1],t=o[2],a=o[3],i=o[4]);var s,r=location.hash.substring(2)||"/dashboard/",l=(this.getNav(this.props.roleInfo,e,t,a,i),n.Tools.getByHash("_from")),d=[];if(l&&(this.state.tabIndex=this.getNameByHas(l)[1]),s||(d=this.getNameByHas(r.replace(/\?.*$/g,"")),s=d[0],l||(this.state.tabIndex=d[1])),n.Tools.tabs=n.Tools.tabs||[],s){var c=!0;n.Tools.tabs.forEach(function(e){e.name===s?(c=!1,e.active=!0,e.href=r):e.active=!1}),c&&n.Tools.tabs.push({name:s,href:r,active:!0}),this.app.children.header.setState({tabs:n.Tools.tabs},!0)}this.state.isEventTab||setTimeout(function(){var e=document.querySelector(".side-item a.active");e&&(document.querySelector(".side-b").scrollTop=e.parentNode.previousSibling.offsetTop)},200)},checkQx:function(e){return e.match(/(insure-|\/clue\/|\/vip\/|\/jiakao-display\/|\/recruit\/|\/market\/)/)&&!this.isManager()?(n.Dialog.alert({content:"\u6743\u9650\u4e0d\u8db3\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458"}),!1):(e.indexOf("?")>=0&&(e=e.substring(0,e.indexOf("?"))),!(!n.Tools.checkUrl(e)&&!n.Tools.checkUrl("/"+e))||(n.Dialog.alert({content:"\u6743\u9650\u4e0d\u8db3\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458"}),!1))},didMount:function(){var e=this;n.Tools.router=function(t,a,i){t&&e.checkQx(t)&&(t&&(location.href="#!"+t),e.init(),n.Tools.setHashData(a,!1!==i))},n.Tools.checkUrl=function(t){return t?e.getNameByHas(t)[0]:"\u9996\u9875"},e.init(),n.Deferred.when(n.request("jxb://api/open/admin/jiaxiao-info/detail.htm",{}),n.request("jiaxiao://api/web/v3/jiaxiao-admin/fetch.htm",{})).done(function(t,a){t=t[0];var i=(a=a[0]).userType,o=0===i?!a.payVerify:1===i&&!a.masterAccredit,s=1===a.status&&(2===a.approveStatus||!a.approveStatus&&o),r=2===a.status||3===a.status;e.state.validateArr=[e.props.roleInfo,!t.examFieldCount,!t.courseCount,!t.trainFieldCount,s||r],e.getNav.apply(e,e.state.validateArr),n.Tools.setStorage("jxInfo",t),e.forceUpdate()}),e.updateNavigation(e.props.path),e.event.on("dian","click",function(){e.setState({dian:!e.state.dian}),e.app.setState({sideDian:e.state.dian})}),e.event.on("tabSub","click",function(t){var a=t.refTarget.getAttribute("data-tabindex");e.setState({tabIndex:e.state.tabIndex===a?"":a})}),e.event.on("tabLink","click",function(t){var a=t.refTarget,i=a.getAttribute("data-name");if(1===n.Tools.approveStatus||"\u9996\u9875"===i||"\u8ba4\u8bc1\u4fe1\u606f"===i){var o=a.getAttribute("data-tabindex");a.className.indexOf("side-name")>=0&&e.setState({tabIndex:o}),e.state.isEventTab=!0,setTimeout(function(){e.state.isEventTab=!1},800)}else n.Tools.toastErr()})},willReceiveProps:function(e){this.updateNavigation(e.path)},updateNavigation:function(e){var t=/(\?|&)_from=(\/.*)([^&]*|)/.exec(location.href);t&&(e="#!"+t[2]),e=/#!(\/[^?]*)(\?|)/g.exec(e),this.setState({active:e?e[1]:"/dashboard/"})},name:t.id,view:i})}),Simple.Module({name:"jxb:component/sidebar/view/main",require:[]},function(e,t,a,n){t.exports=n.View.create({id:t.id,isLoad:!0,component:{},events:{},include:[],tagName:"com-sidebar",media:[null],style:["./main"],template:function(e,t,a,n,i){"use strict";var o=[],s=(this.$helpers,e.props,e.self),r=e.state,l=e.meIndex,d=this.$escape,c=this.$each;e.$value,e.$index,e.i1,s.props,r=s.state,l=0;return o.push('<com-sidebar class="'+d(r.dian?"active":"")+'"><div class="side-dian" ref="dian" skip="true"></div><div class="side-b" style="'+d(r.dian?"overflow: inherit;":"")+'">'),c(r.navigation,function(e,t){var a=t;!1!==e.show&&(o.push('<div class="side-title '+d(e.name?"":"hide")+'">'+d(r.dian?e.name.substring(0,2):e.name)+"</div>"),c(e.list,function(e,t){o.push('<div class="side-item d'+d(l)+" "+d(!1!==e.show?"":"hide")+" "+d(r.tabIndex===a+"-"+t?"hover":"")+'">'),l<13&&l++,e.href?o.push('<a href="'+d(e.href)+'" data-name="'+d(e.name)+'" data-tabindex="'+d(a)+"-"+d(t)+'" no="'+d(e.no+"")+'" ref="tabLink" target="_blank" class="side-name '+d(e.icon)+" "+d(0===r.active.indexOf(e.href)?"active":"")+'"><span no="'+d(e.no+"")+'">'+d(e.name)+"</span></a>"):(o.push('<div class="side-name '+d(e.icon)+'" ref="tabSub" data-tabindex="'+d(a)+"-"+d(t)+'"><span>'+d(e.name)),e.hot&&o.push('<span class="quan" skip="true"></span>'),o.push('</span><i class="'+d(a+"-"+t===r.tabIndex?"active":"")+'"></i></div>')),e.list&&(o.push('<div class="side-sub" style="height:'+d(a+"-"+t===r.tabIndex?40*e.list.length+"px":"")+'">'),c(e.list,function(e,t){o.push('<a href="'+d(e.href)+'" data-name="'+d(e.name)+'" no="'+d(e.no+"")+'" ref="tabLink" class="'+d(0===r.active.indexOf(e.href)?"active":"")+'">'+d(e.name)),e.hot&&o.push('<span class="quan" skip="true"></span>'),o.push("</a>")}),o.push("</div>")),o.push("</div>")}))}),o.push("</div></com-sidebar>"),this.$resolve(o)}})}),Simple.Module({name:"jxb:component/map-dialog/main",require:["./view/main"]},function(e,t,a,n){var i=e("./view/main");t.exports=n.Component.extend({$constructor:function(){this.$super(),this.state={index:0}},onChange:function(e){this.parent.state.pos=e},show:function(e){var t=this;e=e||{},t.setState({showMap:!0},!0),t.children.Dialog.show({title:e.title||"\u5730\u56fe\u9009\u62e9",showBtn:e.showBtn,width:e.width,onConfirm:function(){e.onConfirm&&e.onConfirm.call(t,t.state.pos)}}),t.children.Dialog.children.Map.init({ops:e.ops})},hide:function(){this.children.Dialog.hide()},didMount:function(e){},name:t.id,view:i})}),Simple.Module({name:"jxb:component/map-dialog/view/main",require:["jxb:component/map/main","jxb:component/dialog/main"]},function(e,t,a,n){t.exports=n.View.create({id:t.id,isLoad:!0,component:{Map:e("jxb:component/map/main"),Dialog:e("jxb:component/dialog/main")},events:{},include:[],tagName:"div",media:[null],style:["./main"],template:function(e,t,a,n,i){"use strict";var o=this,s=[],r=(this.$helpers,e.state,e.self),l=function(){return o.$component(arguments,a)};r.state;return s.push('<div class="map-dialog-container">'),s.push(l("Dialog.0",{},function(){var e=[];return e.push(l("Map.0",{onChange:r.onChange},null,"Dialog.0")),e}(),i)),s.push("</div>"),o.$resolve(s)}})}),Simple.Module({name:"jxb:component/map/main",require:["./view/main","./map"]},function(e,t,a,n){var i=e("./view/main"),o=e("./map");t.exports=n.Component.extend({$constructor:function(){this.$super(),this.state={index:0}},init:function(e){var t=this,a=(e=e||{}).ops||{longitude:"",latitude:"",address:""};o.main({search:document.getElementById("search-input"),position:a,callback:function(e){pos=e,t.props.onChange&&t.props.onChange.call(t.parent,e)}})},name:t.id,view:i})}),Simple.Module({name:"jxb:component/map/view/main",require:[]},function(e,t,a,n){t.exports=n.View.create({id:t.id,isLoad:!0,component:{},events:{},include:[],tagName:"div",media:[null],style:["./main"],template:function(e,t,a,n,i){"use strict";var o=[];this.$helpers;return o.push('<div class="map-container" skip="true"><input type="text" class="map-search form-control" id="search-input"><div id="location-target" class="map-content"></div></div>'),this.$resolve(o)}})}),Simple.Module({name:"jxb:component/map/map",require:[]},function(e,t,a,n){var i={PI:3.141592653589793,x_pi:52.35987755982988,delta:function(e,t){var a=6378245,n=.006693421622965943,i=this.transformLat(t-105,e-35),o=this.transformLon(t-105,e-35),s=e/180*this.PI,r=Math.sin(s);r=1-n*r*r;var l=Math.sqrt(r);return{lat:i=180*i/(a*(1-n)/(r*l)*this.PI),lon:o=180*o/(a/l*Math.cos(s)*this.PI)}},gcj_encrypt:function(e,t){if(this.outOfChina(e,t))return{lat:e,lon:t};var a=this.delta(e,t);return{lat:e+a.lat,lon:t+a.lon}},gcj_decrypt:function(e,t){if(this.outOfChina(e,t))return{lat:e,lon:t};var a=this.delta(e,t);return{lat:e-a.lat,lon:t-a.lon}},gcj_decrypt_exact:function(e,t){for(var a,n,i=.01,o=.01,s=e-i,r=t-o,l=e+i,d=t+o,c=0;;){a=(s+l)/2,n=(r+d)/2;var p=this.gcj_encrypt(a,n);if(i=p.lat-e,o=p.lon-t,Math.abs(i)<1e-9&&Math.abs(o)<1e-9)break;if(i>0?l=a:s=a,o>0?d=n:r=n,++c>1e4)break}return{lat:a,lon:n}},bd_encrypt:function(e,t){var a=t,n=e,i=Math.sqrt(a*a+n*n)+2e-5*Math.sin(n*this.x_pi),o=Math.atan2(n,a)+3e-6*Math.cos(a*this.x_pi),s=i*Math.cos(o)+.0065;return{lat:i*Math.sin(o)+.006,lon:s}},bd_decrypt:function(e,t){var a=t-.0065,n=e-.006,i=Math.sqrt(a*a+n*n)-2e-5*Math.sin(n*this.x_pi),o=Math.atan2(n,a)-3e-6*Math.cos(a*this.x_pi),s=i*Math.cos(o);return{lat:i*Math.sin(o),lon:s}},mercator_encrypt:function(e,t){var a=20037508.34*t/180,n=Math.log(Math.tan((90+e)*this.PI/360))/(this.PI/180);return{lat:n=20037508.34*n/180,lon:a}},mercator_decrypt:function(e,t){var a=t/20037508.34*180,n=e/20037508.34*180;return{lat:n=180/this.PI*(2*Math.atan(Math.exp(n*this.PI/180))-this.PI/2),lon:a}},distance:function(e,t,a,n){var i=Math.cos(e*this.PI/180)*Math.cos(a*this.PI/180)*Math.cos((t-n)*this.PI/180)+Math.sin(e*this.PI/180)*Math.sin(a*this.PI/180);return i>1&&(i=1),i<-1&&(i=-1),6371e3*Math.acos(i)},outOfChina:function(e,t){return t<72.004||t>137.8347||(e<.8293||e>55.8271)},transformLat:function(e,t){var a=2*e-100+3*t+.2*t*t+.1*e*t+.2*Math.sqrt(Math.abs(e));return a+=2*(20*Math.sin(6*e*this.PI)+20*Math.sin(2*e*this.PI))/3,a+=2*(20*Math.sin(t*this.PI)+40*Math.sin(t/3*this.PI))/3,a+=2*(160*Math.sin(t/12*this.PI)+320*Math.sin(t*this.PI/30))/3},transformLon:function(e,t){var a=300+e+2*t+.1*e*e+.1*e*t+.1*Math.sqrt(Math.abs(e));return a+=2*(20*Math.sin(6*e*this.PI)+20*Math.sin(2*e*this.PI))/3,a+=2*(20*Math.sin(e*this.PI)+40*Math.sin(e/3*this.PI))/3,a+=2*(150*Math.sin(e/12*this.PI)+300*Math.sin(e/30*this.PI))/3}},o=function(e){var t,a,i,o,s=(e=e||{}).search,r=function(a){a.city&&i.setCity(a.city),i.search(a.name,function(n,i){if("complete"===n&&"OK"===i.info){var o=[],s=i.poiList.pois[0];o.push(s.location.lng),o.push(s.location.lat),e.callback&&e.callback({latitude:o[1],longitude:o[0],address:a.name}),t.setCenter(o),c(o)}})},l=function(e){AMap.plugin(["AMap.PlaceSearch"],function(){i=new AMap.PlaceSearch({map:e})})},d=function(t){AMap.plugin("AMap.Geocoder",function(){new AMap.Geocoder({city:"\u5168\u56fd"}).getAddress(t,function(a,i){if("complete"===a&&i.regeocode){var o=i.regeocode.formattedAddress;s.value=o,e.callback&&e.callback({latitude:t[1],longitude:t[0],address:o})}else n.Dialog.toast("\u6839\u636e\u7ecf\u7eac\u5ea6\u67e5\u8be2\u5730\u5740\u5931\u8d25")})})},c=function(e){a?a.setPosition(e):a=new AMap.Marker({position:e,map:t,offset:new AMap.Pixel(-15,-40),content:'<img src="https://jiaxiaozhijia.image.mucang.cn/jiaxiaozhijia/2019/08/31/14/b7df996f17e8441cbfbad8ee980926a2.png" disabled="true" style="width:25px;height:38px;">'})};if(t=new AMap.Map("location-target",{resizeEnable:!0,zoom:16}),s&&l(),t.on("click",function(e){var a=[e.lnglat.getLng(),e.lnglat.getLat()];t.setCenter(a),c(a),d(a)}),t.on("complete",function(){AMap.plugin("AMap.Autocomplete",function(){var e=new AMap.Autocomplete({input:"search-input"});AMap.event.addListener(e,"select",function(e){var t={};t.name=e.poi.name,t.adcode=e.poi.adcode,r(t)})})}),e.position.latitude&&e.position.longitude){var p=[];p.push(e.position.longitude),p.push(e.position.latitude),t.setCenter(p),c(p),s.value=e.position.address,e.callback&&e.callback(e.position)}else o=function(a){if(a.success){var n=[a.position.lng,a.position.lat];t.setCenter(n),s.value=a.formattedAddress,c(n),e.callback&&e.callback({latitude:a.position.lat,longitude:a.position.lng,address:a.formattedAddress})}else i=function(a){a.success?(t.setBounds(a.citybounds),s.value=a.city,e.callback&&e.callback({isCity:!0})):a.message},AMap.plugin("AMap.CitySearch",function(){(new AMap.CitySearch).getLocalCity(function(e,t){t.success="complete"===e&&"OK"===t.info,i&&i(t)})});var i},AMap.plugin("AMap.Geolocation",function(){var e=new AMap.Geolocation({enableHighAccuracy:!0,timeout:1e4,showMarker:!1,showButton:!1});t.addControl(e),e.getCurrentPosition(function(e,t){t.success="complete"===e,o&&o(t)})})};t.exports={main:function(e){window.AMap?o(e):n.Tools.loadScript("https://webapi.amap.com/maps?v=1.4.6&key=5d4e2bfebc376849b0fd27a963934135",function(t){t?o(e):n.Dialog.alert({content:"\u52a0\u8f7d\u5730\u56fe\u5931\u8d25"})})},GPS:i}});